<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="twitter:site" content="skywalking.apache.org">
<meta name="twitter:image:src" content="https://skywalking.apache.org/images/skywalking_400x400.png">
<meta property="og:image" content="https://skywalking.apache.org/images/skywalking_400x400.png">

<meta name="generator" content="Hugo 0.80.0" />

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3007530_pvozs1rz2wn.css">



<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/site.webmanifest">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<title>BanyanDB Clustering | Apache SkyWalking</title><meta property="og:title" content="BanyanDB Clustering" />
<meta property="og:description" content="BanyanDB Clustering BanyanDB Clustering introduces a robust and scalable architecture that comprises &ldquo;Liaison Nodes&rdquo;, &ldquo;Data Nodes&rdquo;, and &ldquo;Meta Nodes&rdquo;. This structure allows for effectively distributing and managing time-series data within the system.
1. Architectural Overview A BanyanDB installation includes three distinct types of nodes: Data Nodes, Meta Nodes, and Liaison Nodes.
1.1 Data Nodes Data Nodes hold all the raw time series data, metadata, and indexed data. They handle the storage and management of data, including streams and measures, tag keys and values, as well as field keys and values." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/skywalking-banyandb/v0.8.0/concept/clustering/" />

<meta itemprop="name" content="BanyanDB Clustering">
<meta itemprop="description" content="BanyanDB Clustering BanyanDB Clustering introduces a robust and scalable architecture that comprises &ldquo;Liaison Nodes&rdquo;, &ldquo;Data Nodes&rdquo;, and &ldquo;Meta Nodes&rdquo;. This structure allows for effectively distributing and managing time-series data within the system.
1. Architectural Overview A BanyanDB installation includes three distinct types of nodes: Data Nodes, Meta Nodes, and Liaison Nodes.
1.1 Data Nodes Data Nodes hold all the raw time series data, metadata, and indexed data. They handle the storage and management of data, including streams and measures, tag keys and values, as well as field keys and values.">

<meta itemprop="wordCount" content="2391">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BanyanDB Clustering"/>
<meta name="twitter:description" content="BanyanDB Clustering BanyanDB Clustering introduces a robust and scalable architecture that comprises &ldquo;Liaison Nodes&rdquo;, &ldquo;Data Nodes&rdquo;, and &ldquo;Meta Nodes&rdquo;. This structure allows for effectively distributing and managing time-series data within the system.
1. Architectural Overview A BanyanDB installation includes three distinct types of nodes: Data Nodes, Meta Nodes, and Liaison Nodes.
1.1 Data Nodes Data Nodes hold all the raw time series data, metadata, and indexed data. They handle the storage and management of data, including streams and measures, tag keys and values, as well as field keys and values."/>



<link rel="preload" href="/scss/main.min.0c770159917a7e9107bd3454069daa2bf26932350638329b3c9419597d4e6e80.css" as="style">
<link href="/scss/main.min.0c770159917a7e9107bd3454069daa2bf26932350638329b3c9419597d4e6e80.css" rel="stylesheet" integrity="">



<link rel="stylesheet" href="/css/docSearch.css" />
<link rel="stylesheet" href="/css/highlight-github.css" />


<script src="/js/jquery-3.6.0.min.js"></script>





    <title>BanyanDB Clustering | Apache SkyWalking</title>
  </head>
  <body class="td-page  project-doc">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand  flex-column flex-md-row td-navbar">
    <div class="sidebar-button">
      <i class="iconfont icon-menu"></i>
    </div>
    <a class="navbar-brand" href="/">
        <span class="navbar-logo"><img width="130" src="/images/logo.svg" alt="SkyWalking"></span> 
    </a>
    <div class="td-navbar-nav-scroll navbar-nav-wrapper" id="navigation">
        <ul class="navbar-nav mt-lg-0">
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/docs" ><span>Projects and Docs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/events" ><span>Events</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/blog" ><span>Blogs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/downloads" ><span>Downloads</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/team" ><span>Team</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/users" ><span>Users</span></a>
			</li>
            
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
                <span class="link dropdown blog">
                    <a class="link-name nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中文资料</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/zh/">博客</a>
                        <a class="dropdown-item" href="https://space.bilibili.com/390683219" target="_blank" rel="noopener noreferrer">
                            B站
                        </a>
                        <a class="dropdown-item" href="https://juejin.cn/user/13673577331607" target="_blank" rel="noopener noreferrer">
                            掘金
                        </a>
                    </div>
                </span>
            </li>

            
			
        </ul>
    </div>
    <div class="navbar-nav d-none d-lg-block search-input-box">
         
            
        
            
        
            
        
            
        
            
        
            
        
            
            <span class="link dropdown">
                <a class="link-name dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Links
                </a>
                <div class="dropdown-menu">
                    
                    <a class="dropdown-item" href="http://www.apache.org/">Apache Software Foundation</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/issues">GitHub Issue Tracker</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/discussions">Discussion</a> 
                    <a class="dropdown-item" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">Dev Mailing List</a> 
                    <a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/SKYWALKING/Home">WIKI</a> 
                    <a class="dropdown-item" href="http://www.apache.org/licenses/">License</a> 
                    <a class="dropdown-item" href="http://www.apache.org/events/current-event">Apache Events</a> 
                    <a class="dropdown-item" href="http://www.apache.org/security/">Security</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Sponsor and Donate</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a> 
                    <a class="dropdown-item" href="https://apache.org/foundation/policies/privacy.html">Privacy</a> 
                </div>
            </span>
            
        
        
<div id="docsearch"></div>


    </div>
</nav>

    </header>
    <div class="container-fluid td-outer">

      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 d-print-none scroll-bar td-sidebar">











































                  <div class="description-wrapper">
                    <h5>
                    <img width="26" height="26" src="/images/project/banyan-db.svg">
                    BanyanDB
                    </h5>
                    <p>An observability database aims to ingest, analyze and store Metrics, Tracing and Logging data.</p>
                  </div>
                  
                  <div class="version-wrapper">Version: 
                  <select class="version-select">
                  
                    
                    
                    <option ZgotmplZ value="next">
                    
                      next
                    
                    </option>
                  
                    
                    
                    <option ZgotmplZ value="latest">
                    
                      latest
                    
                    </option>
                  
                    
                    
                    <option selected value="v0.8.0">
                    
                      v0.8.0
                    
                    </option>
                  
                  </select>
                  </div>
                  
                  <ul class="sidebar-menu">
    
    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/readme">Welcome</a>
        
    </li>
    
    <li>
        
            
            <a href="#">User Guide<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        

            
            <a href="#">Installation<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/binaries">Get Binaries</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/standalone">Standalone Mode</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/cluster">Cluster Mode</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/docker">Installation On Docker</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/kubernetes">Installation On Kubernetes</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Basic Concepts and Terminology<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/concept/data-model">Data Model</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/guides/quick-start/quick-start">Quick Start Tutorial</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/installation/versions">Versions and Compatibility</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Interacting<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        

            
            <a href="#">CLI<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/bydbctl">bydbctl</a>
        
    </li>

    

    <li>
        

            
            <a href="#">CRUD Schema<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/schema/group">Group</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/schema/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/schema/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/schema/index-rule">IndexRule</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/schema/index-rule-binding">IndexRuleBinding</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Querying Data<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/query/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/query/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/query/filter-operation">Filter Operation</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/property">CRUD Property</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/bydbctl/analyze">Analyzing Data</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Web UI<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/dashboard">Dashboard</a>
        
    </li>

    

    <li>
        

            
            <a href="#">CRUD Schema<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/group">Group</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/index-rule">IndexRule</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/index-rule-binding">IndexRuleBinding</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/schema/top-n-aggregation">Top N Aggregation</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Querying Data<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/query/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/query/stream">Stream</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/web-ui/property">CRUD Property</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/java-client">Java Client</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/interacting/data-lifecycle">Data Lifecycle</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Operation and Maintenance<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/configuration">Configure BanyanDB</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/system">System Configuration</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/upgrade">Upgrade</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/observability">Observability</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/cluster">Cluster Management</a>
        
    </li>

    

    <li>
        

            
            <a href="#">Troubleshooting<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/error-checklist">Error Checklist</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/install">Troubleshooting Installation</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/crash">Troubleshooting Crash</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/no-data">Troubleshooting No Data</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/overhead">Troubleshooting Overhead</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/troubleshooting/query">Troubleshooting Query</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/security">Security</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/backup">Backup</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/restore">Restore</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/operation/lifecycle">Lifecycle Management</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">File Format<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/concept/tsdb">v1.2.0</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Concepts<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/concept/clustering">Clustering</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/concept/tsdb">TSDB</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/v0.8.0/concept/rotation">Data Rotation</a>
        
    </li>

    

</ul>

        
    </li>
    
</ul>
<script src="/js/sidebar-menu.js"></script>
<script>
  (function (){
    $.sidebarMenu($('.sidebar-menu'))
    var path = window.location.pathname;
    var hash = window.location.hash;
    var $a = $('.sidebar-menu a')
    $a.each(function (e){
      if($(this).attr('href')+'/' === path || $(this).attr('href').replace('#','/#') === path+hash){
        $(this).parents('li').addClass('active').show()
      }
    })
    $a.on('click',function (){
      var url = $(this).attr('href')
      if(url!=='#'){
        window.location.href = url
      }
    })
  })()
</script>

                  <div class="commit-id">Commit Id: baf47bf</div>
                




</div>
            <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
              <i class="iconfont icon-menu-doc doc-menu-button"></i>
              
<div class="td-content">
	<h1 id="banyandb-clustering">BanyanDB Clustering</h1>
<p>BanyanDB Clustering introduces a robust and scalable architecture that comprises &ldquo;Liaison Nodes&rdquo;, &ldquo;Data Nodes&rdquo;, and &ldquo;Meta Nodes&rdquo;. This structure allows for effectively distributing and managing time-series data within the system.</p>
<h2 id="1-architectural-overview">1. Architectural Overview</h2>
<p>A BanyanDB installation includes three distinct types of nodes: Data Nodes, Meta Nodes, and Liaison Nodes.</p>
<h3 id="11-data-nodes">1.1 Data Nodes</h3>
<p>Data Nodes hold all the raw time series data, metadata, and indexed data. They handle the storage and management of data, including streams and measures, tag keys and values, as well as field keys and values.</p>
<p>Data Nodes also handle the local query execution. When a query is made, it is directed to a Liaison, which then interacts with Data Nodes to execute the distributed query and return results.</p>
<p>In addition to persistent raw data, Data Nodes also handle TopN aggregation calculation or other computational tasks.</p>
<h3 id="12-meta-nodes">1.2 Meta Nodes</h3>
<p>Meta Nodes is implemented by etcd. They are responsible for maintaining high-level metadata of the cluster, which includes:</p>
<ul>
<li>All nodes in the cluster</li>
<li>All database schemas</li>
</ul>
<h3 id="13-liaison-nodes">1.3 Liaison Nodes</h3>
<p>Liaison Nodes serve as gateways, routing traffic to Data Nodes. In addition to routing, they also provide authentication, TTL, and other security services to ensure secure and effective communication without the cluster.</p>
<p>Liaison Nodes are also responsible for handling computational tasks associated with distributed querying the database. They build query tasks and search for data from Data Nodes.</p>
<h3 id="14-standalone-mode">1.4 Standalone Mode</h3>
<p>BanyanDB integrates multiple roles into a single process in the standalone mode, making it simpler and faster to deploy. This mode is especially useful for scenarios with a limited number of data points or for testing and development purposes.</p>
<p>In this mode, the single process performs the roles of the Liaison Node, Data Node, and Meta Node. It receives requests, maintains metadata, processes queries, and handles data, all within a unified setup.</p>
<h2 id="2-communication-within-a-cluster">2. Communication within a Cluster</h2>
<p>All nodes within a BanyanDB cluster communicate with other nodes according to their roles:</p>
<ul>
<li>Meta Nodes share high-level metadata about the cluster.</li>
<li>Data Nodes store and manage the raw time series data and communicate with Meta Nodes.</li>
<li>Liaison Nodes distribute incoming data to the appropriate Data Nodes. They also handle distributed query execution and communicate with Meta Nodes.</li>
</ul>
<h3 id="nodes-discovery">Nodes Discovery</h3>
<p>All nodes in the cluster are discovered by the Meta Nodes. When a node starts up, it registers itself with the Meta Nodes. The Meta Nodes then share this information with the Liaison Nodes which use it to route requests to the appropriate nodes.</p>
<p>If data nodes are unable to connect to the meta nodes due to network partition or other issues, they will be removed from the meta nodes. However, the liaison nodes will not remove the data nodes from their routing list until the data nodes are also unreachable from the liaison nodes' perspective. This approach ensures that the system can continue to function even if some data nodes are temporarily unavailable from the meta nodes.</p>
<h2 id="3-data-organization">3. <strong>Data Organization</strong></h2>
<p>Different nodes in BanyanDB are responsible for different parts of the database, while Query and Liaison Nodes manage the routing and processing of queries.</p>
<h3 id="31-meta-nodes">3.1 Meta Nodes</h3>
<p>Meta Nodes store all high-level metadata that describes the cluster. This data is kept in an etcd-backed database on disk, including information about the shard allocation of each Data Node. This information is used by the Liaison Nodes to route data to the appropriate Data Nodes, based on the sharding key of the data.</p>
<p>By storing shard allocation information, Meta Nodes help ensure that data is routed efficiently and accurately across the cluster. This information is constantly updated as the cluster changes, allowing for dynamic allocation of resources and efficient use of available capacity.</p>
<h3 id="32-data-nodes">3.2 Data Nodes</h3>
<p>Data Nodes store all raw time series data, metadata, and indexed data. On disk, the data is organized by <code>&lt;group&gt;/shard-&lt;shard_id&gt;/&lt;segment_id&gt;/</code>. The segment is designed to support retention policy.</p>
<h3 id="33-liaison-nodes">3.3 Liaison Nodes</h3>
<p>Liaison Nodes do not store data but manage the routing of incoming requests to the appropriate Query or Data Nodes. They also provide authentication, TTL, and other security services.</p>
<p>They also handle the computational tasks associated with data queries, interacting directly with Data Nodes to execute queries and return results.</p>
<h2 id="4-determining-optimal-node-counts">4. <strong>Determining Optimal Node Counts</strong></h2>
<p>When creating a BanyanDB cluster, choosing the appropriate number of each node type to configure and connect is crucial. The number of Meta Nodes should always be odd, for instance, “3”. The number of Data Nodes scales based on your storage and query needs. The number of Liaison Nodes depends on the expected query load and routing complexity.</p>
<p>If the write and read load is from different sources, it is recommended to separate the Liaison Nodes for write and read. For instance, if the write load is from metrics, trace or log collectors and the read load is from a web application, it is recommended to separate the Liaison Nodes for write and read.</p>
<p>This separation allows for more efficient routing of requests and better performance. It also allows for scaling out of the cluster based on the specific needs of each type of request. For instance, if the write load is high, you can scale out the write Liaison Nodes to handle the increased load.</p>
<p>The BanyanDB architecture allows for efficient clustering, scaling, and high availability, making it a robust choice for time series data management.</p>
<h2 id="5-writes-in-a-cluster">5. Writes in a Cluster</h2>
<p>In BanyanDB, writing data in a cluster is designed to take advantage of the robust capabilities of underlying storage systems, such as Google Compute Persistent Disk or Amazon S3(TBD). These platforms ensure high levels of data durability, making them an optimal choice for storing raw time series data.</p>
<h3 id="51-data-replication">5.1 Data Replication</h3>
<p>Unlike some other systems, BanyanDB does not support application-level replication, which can consume significant disk space. Instead, it delegates the task of replication to these underlying storage systems. This approach simplifies the BanyanDB architecture and reduces the complexity of managing replication at the application level. This approach also results in significant data savings.</p>
<p>The comparison between using a storage system and application-level replication boils down to several key factors: reliability, scalability, and complexity.</p>
<p><strong>Reliability</strong>: A storage system provides built-in data durability by automatically storing data across multiple systems. It&rsquo;s designed to deliver 99.999999999% durability, ensuring data is reliably stored and available when needed. While replication can increase data availability, it&rsquo;s dependent on the application&rsquo;s implementation. Any bugs or issues in the replication logic can lead to data loss or inconsistencies.</p>
<p><strong>Scalability</strong>: A storage system is highly scalable by design and can store and retrieve any amount of data from anywhere. As your data grows, the system grows with you. You don&rsquo;t need to worry about outgrowing your storage capacity. Scaling application-level replication can be challenging. As data grows, so does the need for more disk space and compute resources, potentially leading to increased costs and management complexity.</p>
<p><strong>Complexity</strong>: With the storage system handling replication, the complexity is abstracted away from the user. The user need not concern themselves with the details of how replication is handled. Managing replication at the application level can be complex. It requires careful configuration, monitoring, and potentially significant engineering effort to maintain.</p>
<p>Futhermore, the storage system might be cheaper. For instance, S3 can be more cost-effective because it eliminates the need for additional resources required for application-level replication.  Application-level replication also requires ongoing maintenance, potentially increasing operational costs.</p>
<h3 id="52-data-sharding">5.2 Data Sharding</h3>
<p>Data distribution across the cluster is determined by the <code>shard_num</code> setting for a group and the specified <code>entity</code> in each resource, whether it is a stream or a measure. The combination of the resource’s <code>name</code> and its <code>entity</code> forms the sharding key, which guides data distribution to the appropriate Data Node during write operations.</p>
<p>For example, if a group has 5 shards, the data is distributed across these shards based on the sharding key:</p>
<ul>
<li>Group <code>measure-minute</code> Shard 0</li>
<li>Group <code>measure-minute</code> Shard 1</li>
<li>Group <code>stream-log</code> Shard 0</li>
<li>Group <code>stream-log</code> Shard 1</li>
<li>Group <code>stream-log</code> Shard 2</li>
</ul>
<p>A measure named <code>service_cpm</code> belonging to <code>measure-minute</code> with an entity of <code>service_id</code> &ldquo;frontend&rdquo; will be written to a specific shard based on the hashed value of the sharding key <code>service_cpm:frontend</code>.</p>
<p>Similarly, a stream named <code>system_log</code> belonging to <code>stream-log</code> with an entity combination of <code>service_id</code> &ldquo;frontend&rdquo; and <code>instance_id</code> &ldquo;10.0.0.1&rdquo; will be written to a specific shard based on the hashed value of the sharding key <code>system_log:frontend|10.0.0.1</code>.</p>
<blockquote>
<p>Note: If there are &ldquo;:&rdquo; or &ldquo;|&rdquo; in the entity, they will be prefixed with a backslash &ldquo;&quot;.</p>
</blockquote>
<p>Liaison Nodes play a crucial role in this process by retrieving the <code>Group</code> list from Meta Nodes. This information is essential for efficient data routing, as it allows Liaison Nodes to direct data to the appropriate Data Nodes based on the sharding key.</p>
<p>This sharding strategy ensures that the write load is evenly distributed across the cluster, thereby enhancing write performance and overall system efficiency. BanyanDB sorts the shards by the <code>Group</code> name and the shard ID, then assigns the shards to the Data Nodes in a round-robin fashion. This method guarantees an even distribution of data across the cluster, preventing any single node from becoming a bottleneck.</p>
<p>For example, consider a group with 5 shards and a cluster with 3 Data Nodes. The shards are distributed as follows:</p>
<ul>
<li>Group <code>measure-minute</code> Shard 0: Data Node 1</li>
<li>Group <code>measure-minute</code> Shard 1: Data Node 2</li>
<li>Group <code>stream-log</code> Shard 0: Data Node 3</li>
<li>Group <code>stream-log</code> Shard 1: Data Node 1</li>
<li>Group <code>stream-log</code> Shard 2: Data Node 2</li>
</ul>
<h3 id="53-data-write-path">5.3 Data Write Path</h3>
<p>Here&rsquo;s a text-based diagram illustrating the data write path in BanyanDB:</p>
<pre><code>User
 |
 | API Request (Write)
 |
 v
------------------------------------
|          Liaison Node             |   &lt;--- Stateless Node, Routes Request
| (Identifies relevant Data Nodes   |
|  and dispatches write request)    |
------------------------------------
       |                            
       v                            
-----------------  -----------------  -----------------
|  Data Node 1  |  |  Data Node 2  |  |  Data Node 3  |
|  (Shard 1)    |  |  (Shard 2)    |  |  (Shard 3)    |
-----------------  -----------------  -----------------

</code></pre><ol>
<li>A user makes an API request to the Liaison Node. This request is a write request, containing the data to be written to the database.</li>
<li>The Liaison Node, which is stateless, identifies the relevant Data Nodes that will store the data based on the entity specified in the request.</li>
<li>The write request is executed across the identified Data Nodes. Each Data Node writes the data to its shard.</li>
</ol>
<p>This architecture allows BanyanDB to execute write requests efficiently across a distributed system, leveraging the stateless nature and routing/writing capabilities of the Liaison Node, and the distributed storage of Data Nodes.</p>
<h2 id="6-queries-in-a-cluster">6. Queries in a Cluster</h2>
<p>BanyanDB utilizes a distributed architecture that allows for efficient query processing. When a query is made, it is directed to a Liaison Node.</p>
<h3 id="61-query-routing">6.1 Query Routing</h3>
<p>Liaison Nodes do not use shard mapping information from Meta Nodes to execute distributed queries. Instead, they access all Data Nodes to retrieve the necessary data for queries. As the query load is lower, it is practical for liaison nodes to access all data nodes for this purpose. It may increase network traffic, but simplifies scaling out of the cluster.</p>
<p>Compared to the write load, the query load is relatively low. For instance, in a time series database, the write load is typically 100x higher than the query load. This is because the write load is driven by the number of devices sending data to the database, while the query load is driven by the number of users accessing the data.</p>
<p>This strategy enables scaling out of the cluster. When the cluster scales out, the liaison node can access all data nodes without any mapping info changes. It eliminates the need to backup previous shard mapping information, reducing complexity of scaling out.</p>
<h3 id="62-query-execution">6.2 Query Execution</h3>
<p>Parallel execution significantly enhances the efficiency of data retrieval and reduces the overall query processing time. It allows for faster response times as the workload of the query is shared across multiple shards, each working on their part of the problem simultaneously. This feature makes BanyanDB particularly effective for large-scale data analysis tasks.</p>
<p>In summary, BanyanDB&rsquo;s approach to querying leverages its unique distributed architecture, enabling high-performance data retrieval across multiple shards in parallel.</p>
<h3 id="63-query-path">6.3 Query Path</h3>
<pre><code>User
 |
 | API Request (Query)
 |
 v
------------------------------------
|          Liaison Node            |   &lt;--- Stateless Node, Distributes Query
|  (Access all Data nodes to       |
|  execute distributed queries)    |
------------------------------------
       |              |              |
       v              v              v
-----------------  -----------------  -----------------
|  Data Node 1  |  |  Data Node 2  |  |  Data Node 3  |
|  (Shard 1)    |  |  (Shard 2)    |  |  (Shard 3)    |
-----------------  -----------------  -----------------

</code></pre><ol>
<li>A user makes an API request to the Liaison Node. This request may be a query for specific data.</li>
<li>The Liaison Node builds a distributed query to select all data nodes.</li>
<li>The query is executed in parallel across all Data Nodes. Each Data Node execute a local query plan to process the data stored in its shard concurrently with the others.</li>
<li>The results from each shard are then returned to the Liaison Node, which consolidates them into a single response to the user.</li>
</ol>
<p>This architecture allows BanyanDB to execute queries efficiently across a distributed system, leveraging the distributed query capabilities of the Liaison Node and the parallel processing of Data Nodes.</p>
<h2 id="7-failover">7. Failover</h2>
<p>BanyanDB is designed to be highly available and fault-tolerant.</p>
<p>In case of a Data Node failure, the system can automatically recover and continue to operate.</p>
<p>Liaison nodes have a built-in mechanism to detect the failure of a Data Node. When a Data Node fails, the Liaison Node will automatically route requests to other available Data Nodes with the same shard. This ensures that the system remains operational even in the face of node failures. Thanks to the query mode, which allows Liaison Nodes to access all Data Nodes, the system can continue to function even if some Data Nodes are unavailable. When the failed data nodes are restored, the system won&rsquo;t reply data to them since the data is still retrieved from other nodes.</p>
<p>In the case of a Liaison Node failure, the system can be configured to have multiple Liaison Nodes for redundancy. If one Liaison Node fails, the other Liaison Nodes can take over its responsibilities, ensuring that the system remains available.</p>
<blockquote>
<p>Please note that any written request which triggers the failover process will be rejected, and the client should re-send the request.</p>
</blockquote>

</div>
<div>
  
  
  
  <div id="edit-github">
    <svg
      fill="currentColor"
      height="20"
      width="20"
      viewBox="0 0 40 40"
      aria-hidden="true"
      style="margin-right: 0.1em;vertical-align: sub; color: #3176d9">
      <g>
        <path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z" />
      </g>
    </svg>
    <a class="github-link" title="Edit this page" href="" target="_blank">
      <span id="edit-github-text">Edit this page</span>
    </a>
  </div>
  
</div>
<script>
  let reg = /\/docs\/[a-zA-Z\-]+\/([\w|\.]+)\//;
  let res = reg.exec(location.href);
  let version = res && res[1];
  let editGithub = document.getElementById("edit-github");
  if (editGithub) {
    editGithub.style.display = version === "next" ? "block" : "none";
  }
  
  if (version === "next") {
    reg = /\/docs\/(.+?)\//;
    let repoRes = reg.exec(location.href);
    let repo = repoRes && repoRes[1];
    if (repo === "main") {
      repo = "skywalking"
    }
    reg = /\/next\/(.+)/;
    let docs = reg.exec(location.href);
    let docsUrl = docs && docs[1];
    if (docsUrl) {
      docsUrl = docsUrl.replace(/readme/i, 'README');
    }
    let prefixUrl = "https://github.com/apache/" + repo + "/blob/master/docs/";
    let editGithubLink = document.querySelector("#edit-github a");
    if (editGithubLink) {
      editGithubLink.href = prefixUrl + docsUrl.replace(/\/$/, ".md");
    }
  }
</script>

            </main>
          <div id="toc" class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">











</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#banyandb-clustering">BanyanDB Clustering</a>
      <ul>
        <li><a href="#1-architectural-overview">1. Architectural Overview</a>
          <ul>
            <li><a href="#11-data-nodes">1.1 Data Nodes</a></li>
            <li><a href="#12-meta-nodes">1.2 Meta Nodes</a></li>
            <li><a href="#13-liaison-nodes">1.3 Liaison Nodes</a></li>
            <li><a href="#14-standalone-mode">1.4 Standalone Mode</a></li>
          </ul>
        </li>
        <li><a href="#2-communication-within-a-cluster">2. Communication within a Cluster</a>
          <ul>
            <li><a href="#nodes-discovery">Nodes Discovery</a></li>
          </ul>
        </li>
        <li><a href="#3-data-organization">3. <strong>Data Organization</strong></a>
          <ul>
            <li><a href="#31-meta-nodes">3.1 Meta Nodes</a></li>
            <li><a href="#32-data-nodes">3.2 Data Nodes</a></li>
            <li><a href="#33-liaison-nodes">3.3 Liaison Nodes</a></li>
          </ul>
        </li>
        <li><a href="#4-determining-optimal-node-counts">4. <strong>Determining Optimal Node Counts</strong></a></li>
        <li><a href="#5-writes-in-a-cluster">5. Writes in a Cluster</a>
          <ul>
            <li><a href="#51-data-replication">5.1 Data Replication</a></li>
            <li><a href="#52-data-sharding">5.2 Data Sharding</a></li>
            <li><a href="#53-data-write-path">5.3 Data Write Path</a></li>
          </ul>
        </li>
        <li><a href="#6-queries-in-a-cluster">6. Queries in a Cluster</a>
          <ul>
            <li><a href="#61-query-routing">6.1 Query Routing</a></li>
            <li><a href="#62-query-execution">6.2 Query Execution</a></li>
            <li><a href="#63-query-path">6.3 Query Path</a></li>
          </ul>
        </li>
        <li><a href="#7-failover">7. Failover</a></li>
      </ul>
    </li>
  </ul>
</nav>




<script>
  $(function () {
    var $toc = $("#TableOfContents");
    if (!$toc || !$toc.length) {
      return;
    }
    var top = $toc.offset().top;
    $(window).on("scroll", debounce(setTop, 100))
    $(window).on("scroll", debounce(addActive, 30))

    function addActive() {
      var scrollValue = $(window).scrollTop();
      var topEle = null;
      $.each($('main h1, main h2, main h3'), function (index, item) {
        if ($(item).offset().top - 70 > scrollValue) {
          return
        }
        if (!topEle) {
          topEle = item
        } else if ($(item).offset().top >= $(topEle).offset().top) {
          topEle = item
        }
        if (topEle) {
          var id = $(item).attr('id');
          $toc.find('a').removeClass("active").end().find('a[href="' + '#' + id + '"]').addClass("active")
        }
      })
    }

    function setTop() {
      var scrollValue = $(window).scrollTop();
      if (scrollValue >= top - 70) {
        $toc.addClass('fixed')
      } else {
        $toc.removeClass('fixed')
      }
    }

    function debounce(fn, wait) {
      var timeout = null;
      return function () {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          fn.apply(this, arguments);
        }, wait);
      };
    }
  })

</script>

          </div>

        </div>
      </div>

      
<footer class="py-5 sky-row">
  <div class="container-fluid text-center">
    <div class="">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-color" target="_blank" href="https://twitter.com/asfskywalking">
      <i class="iconfont icon-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-color" target="_blank" href="http://s.apache.org/slack-invite">
      <i class="iconfont icon-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing list" aria-label="Mailing list">
    <a class="text-color" target="_blank" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">
      <i class="iconfont icon-email"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-color" target="_blank" href="https://github.com/apache/skywalking">
      <i class="iconfont icon-github"></i>
    </a>
  </li>
  
</ul>

        
        
    </div>
    <div class="">

        <small class="text-color">&copy; 2017 - 2025 The Apache Software Foundation All Rights Reserved</small>
        
	
    </div>
    <div class="">
      <small class="text-color mt-4">Apache SkyWalking, SkyWalking, Apache, the Apache feather logo, and the Apache SkyWalking project logo are either registered trademarks or trademarks of the Apache Software Foundation.</small>
    </div>
  </div>
</footer>


    </div>
    

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    
<div id="popup">
    <div class="mask">
        <img src=""/>
    </div>
</div>

    <div class="sidebar-mask"></div>
<div class="sidebar">
    <nav class="nav-links">
        <div class="nav-item"><a href="/docs/" class="nav-link">Projects and Documentation</a></div>
        <div class="nav-item"><a href="/events/" class="nav-link">Events</a></div>
        <div class="nav-item"><a href="/blog/" class="nav-link router-link-exact-active router-link-active">Blog</a>
        </div>
        <div class="nav-item"><a href="/downloads/" class="nav-link">Downloads</a></div>
        <div class="nav-item"><a href="/team/" class="nav-link">Team</a></div>
        <div class="nav-item"><a href="/users/" class="nav-link">Users</a></div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title"><span>中文资料</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="/zh/" class="nav-link external">博客</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://space.bilibili.com/390683219" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">B站</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://juejin.cn/user/13673577331607" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">掘金</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title">
                    <span>Links</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Apache Software Foundation
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://github.com/apache/skywalking/issues"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            GitHub Issue Tracker
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://lists.apache.org/list.html?dev@skywalking.apache.org" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Dev Mailing List
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/licenses/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            License
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/events/current-event"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Apache Events
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/security/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Security
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/sponsorship.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Sponsorship and Donate
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/thanks.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Thanks
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

    <script src="/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>









<script src="/js/main.min.d00d7a99f9e61382b1db35fac38e0e7bdd97f8d3c663a4c4b8d02c3f1d78d894.js" integrity="sha256-0A16mfnmE4Kx2zX6w44Oe92X&#43;NPGY6TEuNAsPx142JQ=" crossorigin="anonymous"></script>


<script src="/js/highlight.min.js"></script>
<script src="/js/mermaid.min.js"></script>
<script>
    window.onload = () => mermaid.init(undefined, ".language-mermaid");
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('pre code.language-json5').forEach((block) => {
      if (block.classList.contains('language-json5')) {
        try {
          hljs.registerLanguage('json5', function(hljs) {
            return hljs.getLanguage('json');
          });
          hljs.highlightElement(block);
        } catch (error) {
          console.error("Error parsing JSON5:", error);
        }
      }
    });
  });
</script>


<script defer
src="https://widget.kapa.ai/kapa-widget.bundle.js"
data-website-id="8a08392b-9c4d-4816-8bc4-f93e0ecdd2a7"
data-project-name="SkyWalking"
data-project-color="#2B74B8"
data-button-text="Ask AI"
data-search-mode-enabled="true"
data-modal-open-on-command-k="true"
data-modal-disclaimer="The AI supports multiple languages, but it may not be accessible in China, a proxy is required."
data-project-logo="https://miro.medium.com/v2/resize:fit:2400/0*kmS-5BQ8ShAhZ_F4.jpg"
data-modal-example-questions="What is Apache SkyWalking?,How to deploy SkyWalking?,How to inject agents non-intrusively?,How to setup trace sampling?"
data-button-position-top=""
data-button-position-right="20px"
data-button-position-bottom="200px"
data-button-position-left=""
data-consent-required="true"  
data-user-analytics-cookie-enabled="true"  
data-consent-screen-title="Help us improve our AI assistant"  
data-consent-screen-disclaimer="By clicking 'Allow tracking', you consent to anonymous user tracking which helps us improve our service. We don't collect any personally identifiable information."  
data-consent-screen-accept-button-text="Allow tracking"  
data-consent-screen-reject-button-text="No, thanks"
></script>




  </body>
  <script>
    $(function (){
      $('.doc-menu-button').on('click',function (){
        $('.td-sidebar').toggleClass('active')
      })
      $('.version-select').on('change', function (){
        var selectVersion = $(this).val().toLowerCase();
        var prefix = '';
        var url = location.href.replace(/(\/docs\/[a-zA-Z\-]+\/)([\w|\.]+)(\/.*)/, function (match, p1, p2, p3){
          prefix = p1 + selectVersion;
          return p1 + selectVersion + p3
        })
        go2SelectVersion(url, prefix)

      })
      function go2SelectVersion(url, prefix){
        $.ajax({
          url: url,
          type: "get",
          success:function(){
            location.href = url;
          },
          statusCode: {
            404:function(){
              location.href = prefix + '/readme/';
            }
          }
        });
      }
    })
  </script>
</html>
