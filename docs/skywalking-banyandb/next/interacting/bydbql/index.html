<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="twitter:site" content="skywalking.apache.org">
<meta name="twitter:image:src" content="https://skywalking.apache.org/images/skywalking_400x400.png">
<meta property="og:image" content="https://skywalking.apache.org/images/skywalking_400x400.png">

<meta name="generator" content="Hugo 0.80.0" />

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3007530_pvozs1rz2wn.css">



<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/site.webmanifest">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<title>BanyanDB Query Language (BydbQL) | Apache SkyWalking</title><meta property="og:title" content="BanyanDB Query Language (BydbQL)" />
<meta property="og:description" content="BanyanDB Query Language (BydbQL) 1. Introduction 1.1. Purpose This document outlines the design of the BanyanDB Data Query Language (BydbQL), a unified query language with SQL-like syntax for all of BanyanDB&rsquo;s data models. The primary goal of BydbQL is to provide users with a familiar, intuitive, and powerful interface to interact with their data, abstracting the underlying protobuf-based APIs for streams, measures, properties, and Top-N queries.
This document specifies the language&rsquo;s syntax, its semantics, and the precise mapping from BydbQL statements to the various Request messages." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/skywalking-banyandb/next/interacting/bydbql/" />

<meta itemprop="name" content="BanyanDB Query Language (BydbQL)">
<meta itemprop="description" content="BanyanDB Query Language (BydbQL) 1. Introduction 1.1. Purpose This document outlines the design of the BanyanDB Data Query Language (BydbQL), a unified query language with SQL-like syntax for all of BanyanDB&rsquo;s data models. The primary goal of BydbQL is to provide users with a familiar, intuitive, and powerful interface to interact with their data, abstracting the underlying protobuf-based APIs for streams, measures, properties, and Top-N queries.
This document specifies the language&rsquo;s syntax, its semantics, and the precise mapping from BydbQL statements to the various Request messages.">

<meta itemprop="wordCount" content="4249">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BanyanDB Query Language (BydbQL)"/>
<meta name="twitter:description" content="BanyanDB Query Language (BydbQL) 1. Introduction 1.1. Purpose This document outlines the design of the BanyanDB Data Query Language (BydbQL), a unified query language with SQL-like syntax for all of BanyanDB&rsquo;s data models. The primary goal of BydbQL is to provide users with a familiar, intuitive, and powerful interface to interact with their data, abstracting the underlying protobuf-based APIs for streams, measures, properties, and Top-N queries.
This document specifies the language&rsquo;s syntax, its semantics, and the precise mapping from BydbQL statements to the various Request messages."/>



<link rel="preload" href="/scss/main.min.0c770159917a7e9107bd3454069daa2bf26932350638329b3c9419597d4e6e80.css" as="style">
<link href="/scss/main.min.0c770159917a7e9107bd3454069daa2bf26932350638329b3c9419597d4e6e80.css" rel="stylesheet" integrity="">



<link rel="stylesheet" href="/css/docSearch.css" />
<link rel="stylesheet" href="/css/highlight-github.css" />


<script src="/js/jquery-3.6.0.min.js"></script>





    <title>BanyanDB Query Language (BydbQL) | Apache SkyWalking</title>
  </head>
  <body class="td-page  project-doc">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand  flex-column flex-md-row td-navbar">
    <div class="sidebar-button">
      <i class="iconfont icon-menu"></i>
    </div>
    <a class="navbar-brand" href="/">
        <span class="navbar-logo"><img width="130" src="/images/logo.svg" alt="SkyWalking"></span> 
    </a>
    <div class="td-navbar-nav-scroll navbar-nav-wrapper" id="navigation">
        <ul class="navbar-nav mt-lg-0">
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/docs" ><span>Projects and Docs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/events" ><span>Events</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/blog" ><span>Blogs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/downloads" ><span>Downloads</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/team" ><span>Team</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/users" ><span>Users</span></a>
			</li>
            
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
                <span class="link dropdown blog">
                    <a class="link-name nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中文资料</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/zh/">博客</a>
                        <a class="dropdown-item" href="https://space.bilibili.com/390683219" target="_blank" rel="noopener noreferrer">
                            B站
                        </a>
                        <a class="dropdown-item" href="https://juejin.cn/user/13673577331607" target="_blank" rel="noopener noreferrer">
                            掘金
                        </a>
                    </div>
                </span>
            </li>

            
			
        </ul>
    </div>
    <div class="navbar-nav d-none d-lg-block search-input-box">
         
            
        
            
        
            
        
            
        
            
        
            
        
            
            <span class="link dropdown">
                <a class="link-name dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Links
                </a>
                <div class="dropdown-menu">
                    
                    <a class="dropdown-item" href="http://www.apache.org/">Apache Software Foundation</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/issues">GitHub Issue Tracker</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/discussions">Discussion</a> 
                    <a class="dropdown-item" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">Dev Mailing List</a> 
                    <a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/SKYWALKING/Home">WIKI</a> 
                    <a class="dropdown-item" href="http://www.apache.org/licenses/">License</a> 
                    <a class="dropdown-item" href="http://www.apache.org/events/current-event">Apache Events</a> 
                    <a class="dropdown-item" href="http://www.apache.org/security/">Security</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Sponsor and Donate</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a> 
                    <a class="dropdown-item" href="https://apache.org/foundation/policies/privacy.html">Privacy</a> 
                </div>
            </span>
            
        
        
<div id="docsearch"></div>


    </div>
</nav>

    </header>
    <div class="container-fluid td-outer">

      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 d-print-none scroll-bar td-sidebar">









































                  <div class="description-wrapper">
                    <h5>
                    <img width="26" height="26" src="/images/project/banyan-db.svg">
                    BanyanDB
                    </h5>
                    <p>An observability database aims to ingest, analyze and store Metrics, Tracing and Logging data.</p>
                  </div>
                  
                  <div class="version-wrapper">Version: 
                  <select class="version-select">
                  
                    
                    
                    <option selected value="next">
                    
                      next
                    
                    </option>
                  
                    
                    
                    <option ZgotmplZ value="latest">
                    
                      latest
                    
                    </option>
                  
                    
                    
                    <option ZgotmplZ value="v0.8.0">
                    
                      v0.8.0
                    
                    </option>
                  
                  </select>
                  </div>
                  
                  <ul class="sidebar-menu">
    
    <li>
        
            <a href="/docs/skywalking-banyandb/next/readme">Welcome</a>
        
    </li>
    
    <li>
        
            
            <a href="#">User Guide<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        

            
            <a href="#">Installation<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/binaries">Get Binaries</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/standalone">Standalone Mode</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/cluster">Cluster Mode</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/docker">Installation On Docker</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/kubernetes">Installation On Kubernetes</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Basic Concepts and Terminology<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/data-model">Data Model</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/guides/quick-start/quick-start">Quick Start Tutorial</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/installation/versions">Versions and Compatibility</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Interacting<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        

            
            <a href="#">CLI<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/bydbctl">bydbctl</a>
        
    </li>

    

    <li>
        

            
            <a href="#">CRUD Schema<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/group">Group</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/index-rule">IndexRule</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/index-rule-binding">IndexRuleBinding</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/schema/top-n-aggregation">Top N Aggregation</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Querying Data<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/query/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/query/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/query/filter-operation">Filter Operation</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/query/top-n-aggregation">Top N Aggregation</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/property">CRUD Property</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbctl/analyze">Analyzing Data</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Web UI<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/dashboard">Dashboard</a>
        
    </li>

    

    <li>
        

            
            <a href="#">CRUD Schema<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/group">Group</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/stream">Stream</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/index-rule">IndexRule</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/index-rule-binding">IndexRuleBinding</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/schema/top-n-aggregation">Top N Aggregation</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        

            
            <a href="#">Querying Data<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/query/measure">Measure</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/query/stream">Stream</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/web-ui/property">CRUD Property</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/java-client">Java Client</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/data-lifecycle">Data Lifecycle</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/interacting/bydbql">BydbQL(TBD)</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Operation and Maintenance<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/configuration">Configure BanyanDB</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/disk-management">Disk Management</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/system">System Configuration</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/upgrade">Upgrade</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/observability">Observability</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/cluster">Cluster Management</a>
        
    </li>

    

    <li>
        

            
            <a href="#">Troubleshooting<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/error-checklist">Error Checklist</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/install">Troubleshooting Installation</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/crash">Troubleshooting Crash</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/no-data">Troubleshooting No Data</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/overhead">Troubleshooting Overhead</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/troubleshooting/query">Troubleshooting Query</a>
        
    </li>

    

</ul>

        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/security">Security</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/backup">Backup</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/restore">Restore</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/operation/lifecycle">Lifecycle Management</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/property-repair">Property Background Repair</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">File Format<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/tsdb">v1.3.0</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Concepts<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/clustering">Clustering</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/tsdb">TSDB</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/rotation">Data Rotation</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/concept/property-repair">Property Background Repair</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Contribute<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-banyandb/next/contribute/debugging">Debugging</a>
        
    </li>

    

</ul>

        
    </li>
    
</ul>
<script src="/js/sidebar-menu.js"></script>
<script>
  (function (){
    $.sidebarMenu($('.sidebar-menu'))
    var path = window.location.pathname;
    var hash = window.location.hash;
    var $a = $('.sidebar-menu a')
    $a.each(function (e){
      if($(this).attr('href')+'/' === path || $(this).attr('href').replace('#','/#') === path+hash){
        $(this).parents('li').addClass('active').show()
      }
    })
    $a.on('click',function (){
      var url = $(this).attr('href')
      if(url!=='#'){
        window.location.href = url
      }
    })
  })()
</script>

                  <div class="commit-id">Commit Id: 9e69b53</div>
                






</div>
            <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
              <i class="iconfont icon-menu-doc doc-menu-button"></i>
              
<div class="td-content">
	<h1 id="banyandb-query-language-bydbql">BanyanDB Query Language (BydbQL)</h1>
<h2 id="1-introduction">1. Introduction</h2>
<h3 id="11-purpose">1.1. Purpose</h3>
<p>This document outlines the design of the BanyanDB Data Query Language (BydbQL), a unified query language with SQL-like syntax for all of BanyanDB&rsquo;s data models. The primary goal of BydbQL is to provide users with a familiar, intuitive, and powerful interface to interact with their data, abstracting the underlying protobuf-based APIs for streams, measures, properties, and Top-N queries.</p>
<p>This document specifies the language&rsquo;s syntax, its semantics, and the precise mapping from BydbQL statements to the various <code>Request</code> messages.</p>
<h3 id="12-scope">1.2. Scope</h3>
<p>BydbQL supports querying across BanyanDB&rsquo;s primary data models:</p>
<ul>
<li><strong>Streams</strong>: For raw, time-series elements like logs and traces.</li>
<li><strong>Measures</strong>: For aggregated numerical time-series data (metrics).</li>
<li><strong>Properties</strong>: For metadata and key-value information.</li>
</ul>
<p>It also provides a specialized syntax for optimized <strong>Top-N</strong> queries against measures.</p>
<h2 id="2-core-concepts">2. Core Concepts</h2>
<h3 id="21-parser-architecture">2.1. Parser Architecture</h3>
<p>BydbQL queries will be processed by a classic three-stage compiler front-end architecture, which ensures modularity and maintainability.</p>
<pre><code>BydbQL Query String
        ↓
      Lexer
        ↓
     Parser
        ↓
Abstract Syntax Tree (AST)
        ↓
   Transformer
        ↓
  Protobuf Request
</code></pre><ul>
<li><strong>Lexer</strong>: Breaks the query string into a sequence of tokens.</li>
<li><strong>Parser</strong>: Builds an Abstract Syntax Tree (AST) from the tokens, validating the query&rsquo;s syntax.</li>
<li><strong>Transformer</strong>: Traverses the AST, performs semantic analysis using a schema, and transforms the AST into the appropriate target protobuf <code>Request</code> message.</li>
</ul>
<h3 id="22-distinguishing-query-types">2.2. Distinguishing Query Types</h3>
<p>BydbQL distinguishes the target data model either explicitly through keywords in the <code>FROM</code> clause or implicitly through the <strong>execution context</strong>. This allows the parser to apply the correct grammar and transformation rules for the query.</p>
<ul>
<li><strong>Explicit</strong>: <code>FROM STREAM &lt;name&gt;</code>, <code>FROM MEASURE &lt;name&gt;</code>, <code>FROM PROPERTY &lt;name&gt;</code></li>
<li><strong>Implicit</strong>: The query is executed against a resource-specific endpoint (e.g., <code>/v1/streams/{stream_name}/query</code>), where the type and name of the resource are known.</li>
</ul>
<p>Specialized queries, like Top-N, use a distinct top-level command and typically require an explicit <code>FROM</code> clause:</p>
<ul>
<li><strong>Top-N</strong>: <code>SHOW TOPN ... FROM MEASURE &lt;measure_name&gt;</code></li>
</ul>
<h3 id="23-optional-from-clause">2.3. Optional <code>FROM</code> Clause</h3>
<p>In BydbQL, the <code>FROM</code> clause is <strong>optional</strong> for <code>SELECT</code> queries. When it is omitted, the target resource (the specific stream, measure, or property) <strong>must</strong> be supplied by the execution context.</p>
<p>The simplest possible BydbQL query is <code>SELECT *</code>. When executed within the context of a stream named <code>sw</code>, this is equivalent to <code>SELECT * FROM STREAM sw</code>.</p>
<p>When the <code>FROM</code> clause is present, it overrides any context provided by the environment. This is useful for clients that connect to a generic query endpoint and need to specify the target resource directly within the query text.</p>
<h3 id="24-case-sensitivity">2.4. Case Sensitivity</h3>
<p>BydbQL follows SQL-like conventions for case sensitivity:</p>
<ul>
<li><strong>Reserved words are case-insensitive</strong>: Keywords like <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, <code>ORDER BY</code>, <code>TIME</code>, <code>BETWEEN</code>, <code>AND</code>, etc. can be written in any case combination.</li>
<li><strong>Identifiers are case-sensitive</strong>: Names of streams, measures, properties, tags, and fields preserve their case and must be referenced exactly as defined.</li>
</ul>
<h4 id="examples">Examples</h4>
<p>All of these queries are equivalent:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">FROM</span> STREAM sw <span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>;

<span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">from</span> stream sw <span style="color:#000;font-weight:bold">where</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>;

<span style="color:#000;font-weight:bold">Select</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">From</span> Stream sw <span style="color:#000;font-weight:bold">Where</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>;
</code></pre></div><p>But these refer to different identifiers:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Different tag names (case-sensitive)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ServiceName <span style="color:#000;font-weight:bold">FROM</span> STREAM sw;  <span style="color:#998;font-style:italic">-- refers to tag &#34;ServiceName&#34;
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> servicename <span style="color:#000;font-weight:bold">FROM</span> STREAM sw;  <span style="color:#998;font-style:italic">-- refers to tag &#34;servicename&#34;
</span><span style="color:#998;font-style:italic"></span>
<span style="color:#998;font-style:italic">-- Different stream names (case-sensitive)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">FROM</span> STREAM MyStream    <span style="color:#998;font-style:italic">-- refers to stream &#34;MyStream&#34;
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">FROM</span> STREAM mystream    <span style="color:#998;font-style:italic">-- refers to stream &#34;mystream&#34;
</span></code></pre></div><p><strong>Best Practice</strong>: Use uppercase for reserved words and consistent casing for identifiers to maintain readability.</p>
<h2 id="25-timestamp-formats">2.5. Timestamp Formats</h2>
<p>BydbQL supports flexible timestamp specifications in TIME clauses, accommodating both absolute and relative time formats:</p>
<h3 id="251-absolute-time-format">2.5.1. Absolute Time Format</h3>
<p>Absolute timestamps use the RFC3339 standard format:</p>
<pre><code>&quot;2006-01-02T15:04:05Z07:00&quot;
</code></pre><p>Examples:</p>
<ul>
<li><code>&quot;2023-01-01T00:00:00Z&quot;</code> - January 1, 2023, 00:00:00 UTC</li>
<li><code>&quot;2023-01-01T15:30:45+08:00&quot;</code> - January 1, 2023, 15:30:45 UTC+8</li>
<li><code>&quot;2023-12-31T23:59:59Z&quot;</code> - December 31, 2023, 23:59:59 UTC</li>
</ul>
<h3 id="252-relative-time-format">2.5.2. Relative Time Format</h3>
<p>Relative timestamps are duration strings that are evaluated relative to the current time:</p>
<pre><code>[-][duration]
</code></pre><p>Supported duration units:</p>
<ul>
<li><code>m</code> - minutes</li>
<li><code>h</code> - hours</li>
<li><code>d</code> - days</li>
<li><code>w</code> - weeks</li>
</ul>
<p>Examples:</p>
<ul>
<li><code>&quot;-30m&quot;</code> - 30 minutes ago</li>
<li><code>&quot;2h&quot;</code> - 2 hours from now</li>
<li><code>&quot;-1d&quot;</code> - 1 day ago</li>
<li><code>&quot;-1w&quot;</code> - 1 week ago</li>
<li><code>&quot;now&quot;</code> - current time</li>
</ul>
<h3 id="253-usage-in-time-clauses">2.5.3. Usage in TIME Clauses</h3>
<p>Both absolute and relative formats can be used interchangeably in TIME conditions:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Absolute time examples
</span><span style="color:#998;font-style:italic"></span>TIME <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span>
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;2023-01-02T00:00:00Z&#39;</span>
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;2023-01-01T08:00:00Z&#39;</span>

<span style="color:#998;font-style:italic">-- Relative time examples  
</span><span style="color:#998;font-style:italic"></span>TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-1h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
TIME <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;-1d&#39;</span>
</code></pre></div><p>The <code>parseTime</code> function automatically determines whether a timestamp is absolute (RFC3339) or relative (duration string) and converts it appropriately.</p>
<h2 id="4-bydbql-for-streams">4. BydbQL for Streams</h2>
<p>BydbQL for streams is designed for querying and retrieving raw time-series elements. The syntax maps to the <code>banyandb.stream.v1.QueryRequest</code> message.</p>
<h3 id="41-grammar">4.1. Grammar</h3>
<pre><code>query           ::= SELECT projection [from_stream_clause] [TIME time_condition] [WHERE criteria] [ORDER BY order_expression] [LIMIT integer] [OFFSET integer] [WITH QUERY_TRACE]
from_stream_clause ::= &quot;FROM STREAM&quot; identifier [&quot;IN&quot; &quot;(&quot; group_list &quot;)&quot;]
projection      ::= &quot;*&quot; | column_list
column_list     ::= identifier (&quot;,&quot; identifier)*
group_list      ::= identifier (&quot;,&quot; identifier)*
criteria        ::= condition ((&quot;AND&quot; | &quot;OR&quot;) condition)*
condition       ::= identifier binary_op (value | value_list)
time_condition  ::= &quot;=&quot; timestamp | &quot;&gt;&quot; timestamp | &quot;&lt;&quot; timestamp | &quot;&gt;=&quot; timestamp | &quot;&lt;=&quot; timestamp | &quot;BETWEEN&quot; timestamp &quot;AND&quot; timestamp
binary_op       ::= &quot;=&quot; | &quot;!=&quot; | &quot;&gt;&quot; | &quot;&lt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot; | &quot;IN&quot; | &quot;NOT IN&quot; | &quot;HAVING&quot; | &quot;NOT HAVING&quot; | &quot;MATCH&quot;
order_expression::= identifier [&quot;ASC&quot; | &quot;DESC&quot;]
value           ::= string_literal | integer_literal | &quot;NULL&quot;
value_list      ::= &quot;(&quot; value (&quot;,&quot; value)* &quot;)&quot;
timestamp       ::= string_literal | integer_literal
	/* timestamp supports both absolute and relative time formats:
	   - Absolute: RFC3339 format like &quot;2006-01-02T15:04:05Z07:00&quot;
	   - Relative: duration strings like &quot;-30m&quot;, &quot;2h&quot;, &quot;1d&quot; (relative to current time) */
identifier      ::= [a-zA-Z_][a-zA-Z0-9_]*
string_literal  ::= &quot;'&quot; [^']* &quot;'&quot; | &quot;\&quot;&quot; [^\&quot;]* &quot;\&quot;&quot;
integer_literal ::= [0-9]+
</code></pre><h3 id="42-mapping-to-streamv1queryrequest">4.2. Mapping to <code>stream.v1.QueryRequest</code></h3>
<ul>
<li><strong><code>FROM STREAM name IN (groups)</code></strong>: Maps to the <code>name</code> and <code>groups</code> fields. If the clause is omitted, these values are taken from the execution context.</li>
<li><strong><code>SELECT tags</code></strong>: Maps to <code>projection</code>. Requires a stream schema to resolve tags to their families.</li>
<li><strong><code>TIME = '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the same timestamp.</li>
<li><strong><code>TIME &gt; '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to the timestamp.</li>
<li><strong><code>TIME BETWEEN '2023-01-01T00:00:00Z' AND '2023-01-02T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the respective timestamps.</li>
<li><strong><code>TIME &gt; '-30m'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to 30 minutes ago.</li>
<li><strong><code>TIME BETWEEN '-1h' AND 'now'</code></strong>: Maps to <code>time_range</code> from 1 hour ago to current time.</li>
<li><strong><code>WHERE conditions</code></strong>: Maps to <code>criteria</code>.</li>
<li><strong><code>ORDER BY field</code></strong>: Maps to <code>order_by</code>.</li>
<li><strong><code>LIMIT</code>/<code>OFFSET</code></strong>: Maps to <code>limit</code> and <code>offset</code>.</li>
<li><strong><code>WITH QUERY_TRACE</code></strong>: Maps to the <code>trace</code> field to enable distributed tracing of query execution.</li>
</ul>
<h3 id="43-examples">4.3. Examples</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Simplest query (context must provide the stream name, e.g., &#39;sw&#39;)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>;

<span style="color:#998;font-style:italic">-- Basic selection with filtering and ordering
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#000;font-weight:bold">default</span>, updated)
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#000;font-weight:bold">state</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Project all tags from a stream (FROM is explicit)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span> 
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw 
<span style="color:#000;font-weight:bold">WHERE</span> <span style="color:#000;font-weight:bold">state</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span> 
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">10</span>;

<span style="color:#998;font-style:italic">-- Use more complex conditions with IN and OR
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#d14">&#39;webapp&#39;</span>, <span style="color:#d14">&#39;api-gateway&#39;</span>) <span style="color:#000;font-weight:bold">OR</span> http.<span style="color:#000;font-weight:bold">method</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;POST&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with time range using TIME clause
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, start_time
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;2023-01-02T00:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query data after a specific timestamp
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;2023-01-01T12:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> <span style="color:#000;font-weight:bold">state</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Query data at an exact timestamp
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;2023-01-01T15:30:00Z&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with relative time - last 30 minutes
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> <span style="color:#000;font-weight:bold">state</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Query with relative time range - last 2 hours
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, start_time
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-2h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query data within the last hour using absolute time
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#d14">&#39;2023-01-01T13:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span>;

<span style="color:#998;font-style:italic">-- Query data older than 1 day ago
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;-1d&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with distributed tracing enabled
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, start_time
<span style="color:#000;font-weight:bold">FROM</span> STREAM sw
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-2h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE;
</code></pre></div><h2 id="5-bydbql-for-measures">5. BydbQL for Measures</h2>
<p>BydbQL for measures is tailored for analytical queries on aggregated numerical data. It supports aggregation, grouping, and mixed selection of tags and fields, mapping to the <code>banyandb.measure.v1.QueryRequest</code> message.</p>
<h3 id="51-grammar">5.1. Grammar</h3>
<pre><code>measure_query     ::= SELECT projection [from_measure_clause] [TIME time_condition] [WHERE criteria] [GROUP BY group_list] [ORDER BY order_expression] [LIMIT integer] [OFFSET integer] [WITH QUERY_TRACE]
from_measure_clause ::= &quot;FROM MEASURE&quot; identifier [&quot;IN&quot; &quot;(&quot; group_list &quot;)&quot;]
projection        ::= &quot;*&quot; | (column_list | agg_function &quot;(&quot; identifier &quot;)&quot; | &quot;TOP&quot; integer projection)
column_list       ::= identifier (&quot;,&quot; identifier)* [&quot;::tag&quot; | &quot;::field&quot;]
agg_function      ::= &quot;SUM&quot; | &quot;MEAN&quot; | &quot;COUNT&quot; | &quot;MAX&quot; | &quot;MIN&quot;
group_list        ::= identifier (&quot;,&quot; identifier)*
criteria          ::= condition ((&quot;AND&quot; | &quot;OR&quot;) condition)*
condition         ::= identifier binary_op (value | value_list)
time_condition    ::= &quot;=&quot; timestamp | &quot;&gt;&quot; timestamp | &quot;&lt;&quot; timestamp | &quot;&gt;=&quot; timestamp | &quot;&lt;=&quot; timestamp | &quot;BETWEEN&quot; timestamp &quot;AND&quot; timestamp
binary_op         ::= &quot;=&quot; | &quot;!=&quot; | &quot;&gt;&quot; | &quot;&lt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot; | &quot;IN&quot; | &quot;NOT IN&quot; | &quot;HAVING&quot; | &quot;NOT HAVING&quot; | &quot;MATCH&quot;
order_expression  ::= identifier [&quot;ASC&quot; | &quot;DESC&quot;]
value             ::= string_literal | integer_literal | &quot;NULL&quot;
value_list        ::= &quot;(&quot; value (&quot;,&quot; value)* &quot;)&quot;
timestamp         ::= string_literal | integer_literal
	/* timestamp supports both absolute and relative time formats:
	   - Absolute: RFC3339 format like &quot;2006-01-02T15:04:05Z07:00&quot;
	   - Relative: duration strings like &quot;-30m&quot;, &quot;2h&quot;, &quot;1d&quot; (relative to current time) */
identifier        ::= [a-zA-Z_][a-zA-Z0-9_]*
string_literal    ::= &quot;'&quot; [^']* &quot;'&quot; | &quot;\&quot;&quot; [^\&quot;]* &quot;\&quot;&quot;
integer_literal   ::= [0-9]+
</code></pre><h3 id="52-bydbql-extensions-for-select">5.2. BydbQL Extensions for <code>SELECT</code></h3>
<p>The <code>SELECT</code> clause for measures is highly flexible, allowing for the selection of tags, fields, and aggregations in a single, flat list.</p>
<ul>
<li><code>SELECT &lt;field_key&gt;, &lt;tag_key&gt;</code>: Returns specific fields and tags. The parser will infer the type of each identifier from the measure&rsquo;s schema.</li>
<li><code>SELECT &lt;identifier&gt;::field, &lt;identifier&gt;::tag</code>: If a field and a tag share the same name, the <code>::field</code> or <code>::tag</code> syntax <strong>must</strong> be used to disambiguate the identifier&rsquo;s type.</li>
<li>The clause also supports aggregation functions (<code>SUM</code>, <code>MEAN</code>, <code>COUNT</code>, <code>MAX</code>, <code>MIN</code>) and a <code>TOP N</code> clause for ranked results.</li>
</ul>
<h3 id="53-mapping-to-measurev1queryrequest">5.3. Mapping to <code>measure.v1.QueryRequest</code></h3>
<ul>
<li><strong><code>FROM MEASURE name IN (groups)</code></strong>: Maps to the <code>name</code> and <code>groups</code> fields. If the clause is omitted, these values are taken from the execution context.</li>
<li><strong><code>SELECT &lt;tag1&gt;, &lt;field1&gt;, &lt;field2&gt;</code></strong>: The transformer inspects each identifier. Those identified as tags (either by schema lookup or <code>::tag</code>) are added to <code>tag_projection</code>. Those identified as fields (by schema lookup or <code>::field</code>) are added to <code>field_projection</code>.</li>
<li><strong><code>SELECT SUM(field)</code></strong>: Maps to <code>agg</code>.</li>
<li><strong><code>TIME = '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the same timestamp.</li>
<li><strong><code>TIME &gt; '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to the timestamp.</li>
<li><strong><code>TIME BETWEEN '2023-01-01T00:00:00Z' AND '2023-01-02T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the respective timestamps.</li>
<li><strong><code>TIME &gt; '-30m'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to 30 minutes ago.</li>
<li><strong><code>TIME BETWEEN '-1h' AND 'now'</code></strong>: Maps to <code>time_range</code> from 1 hour ago to current time.</li>
<li><strong><code>GROUP BY &lt;tag1&gt;, &lt;tag2&gt;</code></strong>: The <code>GROUP BY</code> clause takes a simple list of tags and maps to <code>group_by.tag_projection</code>.</li>
<li><strong><code>SELECT TOP N ...</code></strong>: Maps to the <code>top</code> message.</li>
<li><strong><code>WITH QUERY_TRACE</code></strong>: Maps to the <code>trace</code> field to enable distributed tracing of query execution.</li>
</ul>
<h3 id="54-examples">5.4. Examples</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Simplest query (context must provide measure name)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>;

<span style="color:#998;font-style:italic">-- Select a specific tag and a specific field
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    instance,
    latency
<span style="color:#000;font-weight:bold">WHERE</span> region <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;us-west-1&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">10</span>;

<span style="color:#998;font-style:italic">-- Select multiple tags and fields, with an aggregation
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    region,
    <span style="color:#000;font-weight:bold">SUM</span>(latency)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_cpm
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> region;

<span style="color:#998;font-style:italic">-- Disambiguate a key named &#39;status&#39; that exists as both a tag and a field
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    status::tag,
    status::field
<span style="color:#000;font-weight:bold">FROM</span> MEASURE http_requests
<span style="color:#000;font-weight:bold">WHERE</span> path <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;/api/v1/users&#39;</span>;

<span style="color:#998;font-style:italic">-- Find the top 10 instances with the highest CPU usage for a specific service
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> TOP <span style="color:#099">10</span>
    instance,
    cpu_usage
<span style="color:#000;font-weight:bold">FROM</span> MEASURE instance_metrics
<span style="color:#000;font-weight:bold">WHERE</span> service <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;auth-service&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> cpu_usage <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Select aggregated latency from multiple groups
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    region,
    <span style="color:#000;font-weight:bold">SUM</span>(latency)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_cpm <span style="color:#000;font-weight:bold">IN</span> (us<span style="color:#000;font-weight:bold">-</span>west, us<span style="color:#000;font-weight:bold">-</span>east, eu<span style="color:#000;font-weight:bold">-</span>central)
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> region;

<span style="color:#998;font-style:italic">-- Query measures with time range using TIME clause
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    service,
    <span style="color:#000;font-weight:bold">AVG</span>(response_time)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE http_metrics
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;2023-01-02T00:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> region <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;us-west&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> service;

<span style="color:#998;font-style:italic">-- Query measures after a specific time
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    instance,
    <span style="color:#000;font-weight:bold">MAX</span>(cpu_usage)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE system_metrics
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;2023-01-01T08:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> datacenter <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;dc-1&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> instance
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> <span style="color:#000;font-weight:bold">MAX</span>(cpu_usage) <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query measures at exact timestamp
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    endpoint,
    <span style="color:#000;font-weight:bold">SUM</span>(request_count)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE api_metrics
TIME <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;2023-01-01T10:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> <span style="color:#000;font-weight:bold">method</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;POST&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> endpoint;

<span style="color:#998;font-style:italic">-- Query measures with relative time - last 30 minutes
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    service,
    <span style="color:#000;font-weight:bold">AVG</span>(response_time)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE http_metrics
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> region <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;us-west&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> service;

<span style="color:#998;font-style:italic">-- Query measures with relative time range - last 2 hours
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    instance,
    <span style="color:#000;font-weight:bold">MAX</span>(cpu_usage)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE system_metrics
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-2h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> datacenter <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;dc-1&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> instance
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> <span style="color:#000;font-weight:bold">MAX</span>(cpu_usage) <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query data older than 1 day ago
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    endpoint,
    <span style="color:#000;font-weight:bold">SUM</span>(error_count)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE api_errors
TIME <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;-1d&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;500&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> endpoint;

<span style="color:#998;font-style:italic">-- Query with distributed tracing enabled
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span>
    service,
    <span style="color:#000;font-weight:bold">AVG</span>(response_time)
<span style="color:#000;font-weight:bold">FROM</span> MEASURE http_metrics
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> region <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;us-west&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> service
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE;
</code></pre></div><h2 id="6-bydbql-for-top-n">6. BydbQL for Top-N</h2>
<p>Top-N queries use a specialized, command-like syntax for clarity and to reflect the optimized nature of the underlying <code>banyandb.measure.v1.TopNRequest</code>. The <code>FROM</code> clause is mandatory.</p>
<h3 id="61-grammar">6.1. Grammar</h3>
<pre><code>topn_query         ::= SHOW TOP integer from_measure_clause [TIME time_condition] [WHERE topn_criteria] [AGGREGATE BY agg_function] [ORDER BY value [&quot;ASC&quot;|&quot;DESC&quot;]] [WITH QUERY_TRACE]
from_measure_clause ::= &quot;FROM MEASURE&quot; identifier [&quot;IN&quot; &quot;(&quot; group_list &quot;)&quot;]
topn_criteria      ::= condition ((&quot;AND&quot; | &quot;OR&quot;) condition)*
condition          ::= identifier binary_op (value | value_list)
time_condition     ::= &quot;=&quot; timestamp | &quot;&gt;&quot; timestamp | &quot;&lt;&quot; timestamp | &quot;&gt;=&quot; timestamp | &quot;&lt;=&quot; timestamp | &quot;BETWEEN&quot; timestamp &quot;AND&quot; timestamp
binary_op          ::= &quot;=&quot; | &quot;!=&quot; | &quot;&gt;&quot; | &quot;&lt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot; | &quot;IN&quot; | &quot;NOT IN&quot;
agg_function       ::= &quot;SUM&quot; | &quot;MEAN&quot; | &quot;COUNT&quot; | &quot;MAX&quot; | &quot;MIN&quot;
group_list         ::= identifier (&quot;,&quot; identifier)*
value              ::= string_literal | integer_literal | &quot;NULL&quot;
value_list         ::= &quot;(&quot; value (&quot;,&quot; value)* &quot;)&quot;
timestamp          ::= string_literal | integer_literal
	/* timestamp supports both absolute and relative time formats:
	   - Absolute: RFC3339 format like &quot;2006-01-02T15:04:05Z07:00&quot;
	   - Relative: duration strings like &quot;-30m&quot;, &quot;2h&quot;, &quot;1d&quot; (relative to current time) */
identifier         ::= [a-zA-Z_][a-zA-Z0-9_]*
string_literal     ::= &quot;'&quot; [^']* &quot;'&quot; | &quot;\&quot;&quot; [^\&quot;]* &quot;\&quot;&quot;
integer_literal    ::= [0-9]+
</code></pre><h3 id="62-mapping-to-measurev1topnrequest">6.2. Mapping to <code>measure.v1.TopNRequest</code></h3>
<ul>
<li><strong><code>SHOW TOP N</code></strong>: Maps to <code>top_n</code>.</li>
<li><strong><code>FROM MEASURE name IN (groups)</code></strong>: Maps to the <code>name</code> and <code>groups</code> fields.</li>
<li><strong><code>TIME BETWEEN '2023-01-01T00:00:00Z' AND '2023-01-02T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the respective timestamps.</li>
<li><strong><code>TIME &gt; '-30m'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to 30 minutes ago.</li>
<li><strong><code>TIME BETWEEN '-1h' AND 'now'</code></strong>: Maps to <code>time_range</code> from 1 hour ago to current time.</li>
<li><strong><code>WHERE tag = 'value'</code></strong>: Maps to <code>conditions</code>. Only simple equality is supported.</li>
<li><strong><code>AGGREGATE BY FUNC</code></strong>: Maps to <code>agg</code>.</li>
<li><strong><code>ORDER BY value DESC</code></strong>: Maps to <code>field_value_sort</code>.</li>
<li><strong><code>WITH QUERY_TRACE</code></strong>: Maps to the <code>trace</code> field to enable distributed tracing of query execution.</li>
</ul>
<h3 id="63-examples">6.3. Examples</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Get the Top 10 services with the highest latency
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">10</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_latency
<span style="color:#000;font-weight:bold">WHERE</span> http_method <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;GET&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#000;font-weight:bold">version</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;v1.2.0&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Bottom 5 services with the fewest errors
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">5</span> 
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_errors_total
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">ASC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 3 pods with the most restarts in total over the time range
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">3</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE pod_restarts
<span style="color:#000;font-weight:bold">WHERE</span> namespace <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;production&#39;</span>
<span style="color:#000;font-weight:bold">AGGREGATE</span> <span style="color:#000;font-weight:bold">BY</span> <span style="color:#000;font-weight:bold">SUM</span>;

<span style="color:#998;font-style:italic">-- Get the Top 5 services with the highest error rate across multiple groups
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">5</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_errors <span style="color:#000;font-weight:bold">IN</span> (production, staging)
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 10 services with highest latency in the last hour
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">10</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_latency
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;2023-01-01T13:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 5 endpoints with most errors in a specific time range
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">5</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE endpoint_errors
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;2023-01-02T00:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;500&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 10 services with highest latency in the last hour
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">10</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_latency
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-1h&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 5 endpoints with most errors in the last 24 hours
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">5</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE endpoint_errors
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-24h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;500&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Get the Top 3 services with lowest response time in the last 30 minutes
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">3</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_response_time
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">ASC</span>;

<span style="color:#998;font-style:italic">-- Top-N query with distributed tracing enabled
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SHOW</span> TOP <span style="color:#099">10</span>
<span style="color:#000;font-weight:bold">FROM</span> MEASURE service_latency
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-1h&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> http_method <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;GET&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> value <span style="color:#000;font-weight:bold">DESC</span>
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE;
</code></pre></div><h2 id="7-bydbql-for-properties">7. BydbQL for Properties</h2>
<p>BydbQL for properties is designed for simple key-value lookups and metadata filtering. It maps to the <code>banyandb.property.v1.QueryRequest</code> message.</p>
<h3 id="71-grammar">7.1. Grammar</h3>
<pre><code>property_query      ::= SELECT projection [from_property_clause] [WHERE criteria] [LIMIT integer] [WITH QUERY_TRACE]
from_property_clause ::= &quot;FROM PROPERTY&quot; identifier [&quot;IN&quot; &quot;(&quot; group_list &quot;)&quot;]
projection          ::= &quot;*&quot; | column_list
column_list         ::= identifier (&quot;,&quot; identifier)*
group_list          ::= identifier (&quot;,&quot; identifier)*
criteria            ::= condition ((&quot;AND&quot; | &quot;OR&quot;) condition)*
condition           ::= identifier binary_op (value | value_list) | &quot;ID&quot; binary_op (value | value_list)
binary_op           ::= &quot;=&quot; | &quot;!=&quot; | &quot;&gt;&quot; | &quot;&lt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot; | &quot;IN&quot; | &quot;NOT IN&quot;
value               ::= string_literal | integer_literal | &quot;NULL&quot;
value_list          ::= &quot;(&quot; value (&quot;,&quot; value)* &quot;)&quot;
identifier          ::= [a-zA-Z_][a-zA-Z0-9_]*
string_literal      ::= &quot;'&quot; [^']* &quot;'&quot; | &quot;\&quot;&quot; [^\&quot;]* &quot;\&quot;&quot;
integer_literal     ::= [0-9]+
</code></pre><h3 id="72-mapping-to-propertyv1queryrequest">7.2. Mapping to <code>property.v1.QueryRequest</code></h3>
<ul>
<li><strong><code>FROM PROPERTY name IN (groups)</code></strong>: Maps to the <code>name</code> and <code>groups</code> fields. If the clause is omitted, these values are taken from the execution context.</li>
<li><strong><code>SELECT tags</code></strong>: Maps to <code>tag_projection</code>.</li>
<li><strong><code>WHERE ID IN (...)</code></strong>: Maps to <code>ids</code>.</li>
<li><strong><code>WHERE tag = 'value'</code></strong>: Maps to <code>criteria</code>.</li>
<li><strong><code>LIMIT n</code></strong>: Maps to <code>limit</code>.</li>
<li><strong><code>WITH QUERY_TRACE</code></strong>: Maps to the <code>trace</code> field to enable distributed tracing of query execution.</li>
</ul>
<h3 id="73-examples">7.3. Examples</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Simplest query (context must provide property name)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>;

<span style="color:#998;font-style:italic">-- Find properties by filtering on their tags
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ip, <span style="color:#000;font-weight:bold">owner</span>
<span style="color:#000;font-weight:bold">FROM</span> PROPERTY server_metadata
<span style="color:#000;font-weight:bold">WHERE</span> datacenter <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;dc-101&#39;</span> <span style="color:#000;font-weight:bold">AND</span> in_service <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;true&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">50</span>;

<span style="color:#998;font-style:italic">-- Retrieve a specific property by its unique ID
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span> 
<span style="color:#000;font-weight:bold">WHERE</span> ID <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;server-1a2b3c&#39;</span>;

<span style="color:#998;font-style:italic">-- Retrieve a set of properties by their unique IDs
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ip, region
<span style="color:#000;font-weight:bold">FROM</span> PROPERTY server_metadata
<span style="color:#000;font-weight:bold">WHERE</span> ID <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#d14">&#39;server-1a2b3c&#39;</span>, <span style="color:#d14">&#39;server-4d5e6f&#39;</span>);

<span style="color:#998;font-style:italic">-- Find properties from multiple groups
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ip, <span style="color:#000;font-weight:bold">owner</span>
<span style="color:#000;font-weight:bold">FROM</span> PROPERTY server_metadata <span style="color:#000;font-weight:bold">IN</span> (datacenter<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>, datacenter<span style="color:#000;font-weight:bold">-</span><span style="color:#099">2</span>, datacenter<span style="color:#000;font-weight:bold">-</span><span style="color:#099">3</span>)
<span style="color:#000;font-weight:bold">WHERE</span> in_service <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;true&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Property query with distributed tracing enabled
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ip, region, <span style="color:#000;font-weight:bold">owner</span>
<span style="color:#000;font-weight:bold">FROM</span> PROPERTY server_metadata
<span style="color:#000;font-weight:bold">WHERE</span> datacenter <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;dc-101&#39;</span> <span style="color:#000;font-weight:bold">AND</span> in_service <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;true&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">50</span>
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE;
</code></pre></div><h2 id="8-bydbql-for-traces">8. BydbQL for Traces</h2>
<p>BydbQL for traces is designed for querying and retrieving trace data with spans. The syntax maps to the <code>banyandb.trace.v1.QueryRequest</code> message and is optimized for trace-specific operations.</p>
<h3 id="81-grammar">8.1. Grammar</h3>
<pre><code>trace_query           ::= SELECT projection [from_trace_clause] [TIME time_condition] [WHERE criteria] [ORDER BY order_expression] [LIMIT integer] [OFFSET integer] [WITH QUERY_TRACE]
from_trace_clause     ::= &quot;FROM TRACE&quot; identifier [&quot;IN&quot; &quot;(&quot; group_list &quot;)&quot;]
projection            ::= &quot;*&quot; | column_list | &quot;()&quot;
column_list           ::= identifier (&quot;,&quot; identifier)*
group_list            ::= identifier (&quot;,&quot; identifier)*
criteria              ::= condition ((&quot;AND&quot; | &quot;OR&quot;) condition)*
condition             ::= identifier binary_op (value | value_list)
time_condition        ::= &quot;=&quot; timestamp | &quot;&gt;&quot; timestamp | &quot;&lt;&quot; timestamp | &quot;&gt;=&quot; timestamp | &quot;&lt;=&quot; timestamp | &quot;BETWEEN&quot; timestamp &quot;AND&quot; timestamp
binary_op             ::= &quot;=&quot; | &quot;!=&quot; | &quot;&gt;&quot; | &quot;&lt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot; | &quot;IN&quot; | &quot;NOT IN&quot; | &quot;HAVING&quot; | &quot;NOT HAVING&quot; | &quot;MATCH&quot;
order_expression      ::= identifier [&quot;ASC&quot; | &quot;DESC&quot;]
value                 ::= string_literal | integer_literal | &quot;NULL&quot;
value_list            ::= &quot;(&quot; value (&quot;,&quot; value)* &quot;)&quot;
timestamp             ::= string_literal | integer_literal
	/* timestamp supports both absolute and relative time formats:
	   - Absolute: RFC3339 format like &quot;2006-01-02T15:04:05Z07:00&quot;
	   - Relative: duration strings like &quot;-30m&quot;, &quot;2h&quot;, &quot;1d&quot; (relative to current time) */
identifier            ::= [a-zA-Z_][a-zA-Z0-9_]*
string_literal        ::= &quot;'&quot; [^']* &quot;'&quot; | &quot;\&quot;&quot; [^\&quot;]* &quot;\&quot;&quot;
integer_literal       ::= [0-9]+
</code></pre><h3 id="82-trace-model-characteristics">8.2. Trace Model Characteristics</h3>
<p>The Trace model in BanyanDB is specifically designed for storing and querying trace data with the following key characteristics:</p>
<ul>
<li><strong>Trace Resource</strong>: A logical namespace within a group that defines the structure for trace data</li>
<li><strong>Tags</strong>: Indexed tags that support filtering and querying (defined by <code>TraceTagSpec</code>)</li>
<li><strong>Trace ID Tag</strong>: A specific tag that stores the trace ID for trace correlation</li>
<li><strong>Timestamp Tag</strong>: A specific tag that stores the timestamp for time-based queries</li>
<li><strong>Span Data</strong>: Raw span data stored as binary for efficient storage and retrieval</li>
</ul>
<h3 id="821-empty-projection-support">8.2.1. Empty Projection Support</h3>
<p>BydbQL for traces supports an empty projection syntax <code>SELECT ()</code> that allows queries to return only raw span data without any tag information. This is useful for:</p>
<ul>
<li><strong>Performance Optimization</strong>: When you only need the raw span data and don&rsquo;t want to pay the cost of loading and returning tag values</li>
<li><strong>Data Processing</strong>: When you plan to process the raw span data externally and don&rsquo;t need the indexed tag values</li>
<li><strong>Storage Efficiency</strong>: Reducing network transfer and memory usage by excluding tag data</li>
</ul>
<p><strong>Syntax</strong>: <code>SELECT ()</code> - Returns only raw span data, no tag information
<strong>Behavior</strong>: The query will still apply filtering and ordering based on the WHERE and ORDER BY clauses, but the result will contain only the binary span data without any tag projections.</p>
<h3 id="83-mapping-to-tracev1queryrequest">8.3. Mapping to <code>trace.v1.QueryRequest</code></h3>
<ul>
<li><strong><code>FROM TRACE name IN (groups)</code></strong>: Maps to the <code>name</code> and <code>groups</code> fields. If the clause is omitted, these values are taken from the execution context.</li>
<li><strong><code>SELECT tags</code></strong>: Maps to <code>tag_projection</code>. Requires a trace schema to resolve tags to their specifications.</li>
<li><strong><code>SELECT ()</code></strong>: Maps to an empty <code>tag_projection</code> array, indicating no tag data should be returned (only raw span data).</li>
<li><strong><code>TIME = '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the same timestamp.</li>
<li><strong><code>TIME &gt; '2023-01-01T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to the timestamp.</li>
<li><strong><code>TIME BETWEEN '2023-01-01T00:00:00Z' AND '2023-01-02T00:00:00Z'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> and <code>end</code> set to the respective timestamps.</li>
<li><strong><code>TIME &gt; '-30m'</code></strong>: Maps to <code>time_range</code> with <code>begin</code> set to 30 minutes ago.</li>
<li><strong><code>TIME BETWEEN '-1h' AND 'now'</code></strong>: Maps to <code>time_range</code> from 1 hour ago to current time.</li>
<li><strong><code>WHERE conditions</code></strong>: Maps to <code>criteria</code> for filtering spans based on tag values.</li>
<li><strong><code>ORDER BY field</code></strong>: Maps to <code>order_by</code> for sorting results.</li>
<li><strong><code>LIMIT</code>/<code>OFFSET</code></strong>: Maps to <code>limit</code> and <code>offset</code> for pagination.</li>
<li><strong><code>WITH QUERY_TRACE</code></strong>: Maps to the <code>trace</code> field to enable distributed tracing of query execution.</li>
</ul>
<h3 id="831-naming-convention-clarification">8.3.1. Naming Convention Clarification</h3>
<p>To avoid confusion between different uses of the word &ldquo;trace&rdquo; in BanyanDB:</p>
<ul>
<li><strong>Trace Model</strong>: Refers to the data model for storing trace data (spans, tags, etc.) - used in <code>FROM TRACE</code> clauses</li>
<li><strong>Query Tracing</strong>: Refers to distributed tracing of query execution for observability - enabled with <code>WITH QUERY_TRACE</code></li>
</ul>
<p>The <code>WITH QUERY_TRACE</code> clause enables distributed tracing of the query execution itself, which is separate from querying trace data. When enabled, the query response will include execution trace information in the <code>trace_query_result</code> field.</p>
<h3 id="84-examples">8.4. Examples</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Simplest query (context must provide the trace name, e.g., &#39;sw_trace&#39;)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>;

<span style="color:#998;font-style:italic">-- Basic selection with filtering and ordering
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#000;font-weight:bold">default</span>, updated)
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span> <span style="color:#000;font-weight:bold">AND</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;success&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Project all tags from a trace (FROM is explicit)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span> 
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace 
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span> 
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">10</span>;

<span style="color:#998;font-style:italic">-- Query with no tag projection - returns only raw span data
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ()
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Use more complex conditions with IN and OR
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration, operation_name
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#d14">&#39;webapp&#39;</span>, <span style="color:#d14">&#39;api-gateway&#39;</span>) <span style="color:#000;font-weight:bold">OR</span> http.<span style="color:#000;font-weight:bold">method</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;POST&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with time range using TIME clause
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, start_time, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;2023-01-01T00:00:00Z&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;2023-01-02T00:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query data after a specific timestamp
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;2023-01-01T12:00:00Z&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;success&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Query data at an exact timestamp
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;2023-01-01T15:30:00Z&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with relative time - last 30 minutes
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;

<span style="color:#998;font-style:italic">-- Query with relative time range - last 2 hours
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, start_time, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">BETWEEN</span> <span style="color:#d14">&#39;-2h&#39;</span> <span style="color:#000;font-weight:bold">AND</span> <span style="color:#d14">&#39;now&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query traces by specific trace ID
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span>
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
<span style="color:#000;font-weight:bold">WHERE</span> trace_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;1a2b3c4d5e6f7890&#39;</span>;

<span style="color:#998;font-style:italic">-- Query traces with specific operation names
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, duration
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
<span style="color:#000;font-weight:bold">WHERE</span> operation_name <span style="color:#000;font-weight:bold">IN</span> (<span style="color:#d14">&#39;GET /api/users&#39;</span>, <span style="color:#d14">&#39;POST /api/orders&#39;</span>)
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> duration <span style="color:#000;font-weight:bold">DESC</span>;

<span style="color:#998;font-style:italic">-- Query traces with error status in the last hour
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, error_message
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-1h&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span>
<span style="color:#000;font-weight:bold">ORDER</span> <span style="color:#000;font-weight:bold">BY</span> start_time <span style="color:#000;font-weight:bold">DESC</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">50</span>;

<span style="color:#998;font-style:italic">-- Query traces older than 1 day ago
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, duration, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;-1d&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;legacy-service&#39;</span>;

<span style="color:#998;font-style:italic">-- Query with no projection for raw span data only
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ()
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-1h&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span>
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">50</span>;

<span style="color:#998;font-style:italic">-- Query with distributed tracing enabled for observability
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> trace_id, service_id, operation_name
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
<span style="color:#000;font-weight:bold">WHERE</span> service_id <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;webapp&#39;</span>
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE;

<span style="color:#998;font-style:italic">-- Query with both empty projection and query tracing
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span> ()
<span style="color:#000;font-weight:bold">FROM</span> TRACE sw_trace
TIME <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#d14">&#39;-30m&#39;</span>
<span style="color:#000;font-weight:bold">WHERE</span> status <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;error&#39;</span>
<span style="color:#000;font-weight:bold">WITH</span> QUERY_TRACE
<span style="color:#000;font-weight:bold">LIMIT</span> <span style="color:#099">100</span>;
</code></pre></div><h2 id="9-summary-of-bydbql-capabilities">9. Summary of BydbQL Capabilities</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Feature</th>
<th style="text-align:left">Streams</th>
<th style="text-align:left">Measures</th>
<th style="text-align:left">Top-N</th>
<th style="text-align:left">Properties</th>
<th style="text-align:left">Traces</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Primary Command</strong></td>
<td style="text-align:left"><code>SELECT ... [FROM STREAM]</code></td>
<td style="text-align:left"><code>SELECT ... [FROM MEASURE]</code></td>
<td style="text-align:left"><code>SHOW TOPN ... FROM MEASURE</code></td>
<td style="text-align:left"><code>SELECT ... [FROM PROPERTY]</code></td>
<td style="text-align:left"><code>SELECT ... [FROM TRACE]</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>Projection</strong></td>
<td style="text-align:left">Tags by family</td>
<td style="text-align:left">Tags &amp; Fields</td>
<td style="text-align:left">Implicit (entity, value)</td>
<td style="text-align:left">Flat list of tags</td>
<td style="text-align:left">Tags by specification</td>
</tr>
<tr>
<td style="text-align:left"><strong>Aggregation</strong></td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes (<code>SUM</code>, <code>MEAN</code>, etc.)</td>
<td style="text-align:left">Yes (optional)</td>
<td style="text-align:left">No</td>
<td style="text-align:left">No</td>
</tr>
<tr>
<td style="text-align:left"><strong>Grouping</strong></td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes (<code>GROUP BY</code>)</td>
<td style="text-align:left">No</td>
<td style="text-align:left">No</td>
<td style="text-align:left">No</td>
</tr>
<tr>
<td style="text-align:left"><strong>Filtering</strong></td>
<td style="text-align:left">Full <code>WHERE</code> clause + <code>TIME</code> clause</td>
<td style="text-align:left">Full <code>WHERE</code> clause + <code>TIME</code> clause</td>
<td style="text-align:left">Simple equality <code>WHERE</code> + <code>TIME</code> clause</td>
<td style="text-align:left"><code>WHERE</code> by ID or tags</td>
<td style="text-align:left">Full <code>WHERE</code> clause + <code>TIME</code> clause</td>
</tr>
<tr>
<td style="text-align:left"><strong>Ordering</strong></td>
<td style="text-align:left">Yes (<code>ORDER BY</code>)</td>
<td style="text-align:left">Yes (<code>ORDER BY</code>)</td>
<td style="text-align:left">Yes (<code>ORDER BY value</code>)</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes (<code>ORDER BY</code>)</td>
</tr>
<tr>
<td style="text-align:left"><strong>Pagination</strong></td>
<td style="text-align:left">Yes (<code>LIMIT</code>/<code>OFFSET</code>)</td>
<td style="text-align:left">Yes (<code>LIMIT</code>/<code>OFFSET</code>)</td>
<td style="text-align:left">No</td>
<td style="text-align:left"><code>LIMIT</code> only</td>
<td style="text-align:left">Yes (<code>LIMIT</code>/<code>OFFSET</code>)</td>
</tr>
</tbody>
</table>

</div>
<div>
  
  
  
  <div id="edit-github">
    <svg
      fill="currentColor"
      height="20"
      width="20"
      viewBox="0 0 40 40"
      aria-hidden="true"
      style="margin-right: 0.1em;vertical-align: sub; color: #3176d9">
      <g>
        <path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z" />
      </g>
    </svg>
    <a class="github-link" title="Edit this page" href="" target="_blank">
      <span id="edit-github-text">Edit this page</span>
    </a>
  </div>
  
</div>
<script>
  let reg = /\/docs\/[a-zA-Z\-]+\/([\w|\.]+)\//;
  let res = reg.exec(location.href);
  let version = res && res[1];
  let editGithub = document.getElementById("edit-github");
  if (editGithub) {
    editGithub.style.display = version === "next" ? "block" : "none";
  }
  
  if (version === "next") {
    reg = /\/docs\/(.+?)\//;
    let repoRes = reg.exec(location.href);
    let repo = repoRes && repoRes[1];
    if (repo === "main") {
      repo = "skywalking"
    }
    reg = /\/next\/(.+)/;
    let docs = reg.exec(location.href);
    let docsUrl = docs && docs[1];
    if (docsUrl) {
      docsUrl = docsUrl.replace(/readme/i, 'README');
    }
    let prefixUrl = "https://github.com/apache/" + repo + "/blob/master/docs/";
    let editGithubLink = document.querySelector("#edit-github a");
    if (editGithubLink) {
      editGithubLink.href = prefixUrl + docsUrl.replace(/\/$/, ".md");
    }
  }
</script>

            </main>
          <div id="toc" class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">











</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#banyandb-query-language-bydbql">BanyanDB Query Language (BydbQL)</a>
      <ul>
        <li><a href="#1-introduction">1. Introduction</a>
          <ul>
            <li><a href="#11-purpose">1.1. Purpose</a></li>
            <li><a href="#12-scope">1.2. Scope</a></li>
          </ul>
        </li>
        <li><a href="#2-core-concepts">2. Core Concepts</a>
          <ul>
            <li><a href="#21-parser-architecture">2.1. Parser Architecture</a></li>
            <li><a href="#22-distinguishing-query-types">2.2. Distinguishing Query Types</a></li>
            <li><a href="#23-optional-from-clause">2.3. Optional <code>FROM</code> Clause</a></li>
            <li><a href="#24-case-sensitivity">2.4. Case Sensitivity</a></li>
          </ul>
        </li>
        <li><a href="#25-timestamp-formats">2.5. Timestamp Formats</a>
          <ul>
            <li><a href="#251-absolute-time-format">2.5.1. Absolute Time Format</a></li>
            <li><a href="#252-relative-time-format">2.5.2. Relative Time Format</a></li>
            <li><a href="#253-usage-in-time-clauses">2.5.3. Usage in TIME Clauses</a></li>
          </ul>
        </li>
        <li><a href="#4-bydbql-for-streams">4. BydbQL for Streams</a>
          <ul>
            <li><a href="#41-grammar">4.1. Grammar</a></li>
            <li><a href="#42-mapping-to-streamv1queryrequest">4.2. Mapping to <code>stream.v1.QueryRequest</code></a></li>
            <li><a href="#43-examples">4.3. Examples</a></li>
          </ul>
        </li>
        <li><a href="#5-bydbql-for-measures">5. BydbQL for Measures</a>
          <ul>
            <li><a href="#51-grammar">5.1. Grammar</a></li>
            <li><a href="#52-bydbql-extensions-for-select">5.2. BydbQL Extensions for <code>SELECT</code></a></li>
            <li><a href="#53-mapping-to-measurev1queryrequest">5.3. Mapping to <code>measure.v1.QueryRequest</code></a></li>
            <li><a href="#54-examples">5.4. Examples</a></li>
          </ul>
        </li>
        <li><a href="#6-bydbql-for-top-n">6. BydbQL for Top-N</a>
          <ul>
            <li><a href="#61-grammar">6.1. Grammar</a></li>
            <li><a href="#62-mapping-to-measurev1topnrequest">6.2. Mapping to <code>measure.v1.TopNRequest</code></a></li>
            <li><a href="#63-examples">6.3. Examples</a></li>
          </ul>
        </li>
        <li><a href="#7-bydbql-for-properties">7. BydbQL for Properties</a>
          <ul>
            <li><a href="#71-grammar">7.1. Grammar</a></li>
            <li><a href="#72-mapping-to-propertyv1queryrequest">7.2. Mapping to <code>property.v1.QueryRequest</code></a></li>
            <li><a href="#73-examples">7.3. Examples</a></li>
          </ul>
        </li>
        <li><a href="#8-bydbql-for-traces">8. BydbQL for Traces</a>
          <ul>
            <li><a href="#81-grammar">8.1. Grammar</a></li>
            <li><a href="#82-trace-model-characteristics">8.2. Trace Model Characteristics</a></li>
            <li><a href="#821-empty-projection-support">8.2.1. Empty Projection Support</a></li>
            <li><a href="#83-mapping-to-tracev1queryrequest">8.3. Mapping to <code>trace.v1.QueryRequest</code></a></li>
            <li><a href="#831-naming-convention-clarification">8.3.1. Naming Convention Clarification</a></li>
            <li><a href="#84-examples">8.4. Examples</a></li>
          </ul>
        </li>
        <li><a href="#9-summary-of-bydbql-capabilities">9. Summary of BydbQL Capabilities</a></li>
      </ul>
    </li>
  </ul>
</nav>




<script>
  $(function () {
    var $toc = $("#TableOfContents");
    if (!$toc || !$toc.length) {
      return;
    }
    var top = $toc.offset().top;
    $(window).on("scroll", debounce(setTop, 100))
    $(window).on("scroll", debounce(addActive, 30))

    function addActive() {
      var scrollValue = $(window).scrollTop();
      var topEle = null;
      $.each($('main h1, main h2, main h3'), function (index, item) {
        if ($(item).offset().top - 70 > scrollValue) {
          return
        }
        if (!topEle) {
          topEle = item
        } else if ($(item).offset().top >= $(topEle).offset().top) {
          topEle = item
        }
        if (topEle) {
          var id = $(item).attr('id');
          $toc.find('a').removeClass("active").end().find('a[href="' + '#' + id + '"]').addClass("active")
        }
      })
    }

    function setTop() {
      var scrollValue = $(window).scrollTop();
      if (scrollValue >= top - 70) {
        $toc.addClass('fixed')
      } else {
        $toc.removeClass('fixed')
      }
    }

    function debounce(fn, wait) {
      var timeout = null;
      return function () {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          fn.apply(this, arguments);
        }, wait);
      };
    }
  })

</script>

          </div>

        </div>
      </div>

      
<footer class="py-5 sky-row">
  <div class="container-fluid text-center">
    <div class="">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-color" target="_blank" href="https://twitter.com/asfskywalking">
      <i class="iconfont icon-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-color" target="_blank" href="http://s.apache.org/slack-invite">
      <i class="iconfont icon-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing list" aria-label="Mailing list">
    <a class="text-color" target="_blank" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">
      <i class="iconfont icon-email"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-color" target="_blank" href="https://github.com/apache/skywalking">
      <i class="iconfont icon-github"></i>
    </a>
  </li>
  
</ul>

        
        
    </div>
    <div class="">

        <small class="text-color">&copy; 2017 - 2025 The Apache Software Foundation All Rights Reserved</small>
        
	
    </div>
    <div class="">
      <small class="text-color mt-4">Apache SkyWalking, SkyWalking, Apache, the Apache feather logo, and the Apache SkyWalking project logo are either registered trademarks or trademarks of the Apache Software Foundation.</small>
    </div>
  </div>
</footer>


    </div>
    

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    
<div id="popup">
    <div class="mask">
        <img src=""/>
    </div>
</div>

    <div class="sidebar-mask"></div>
<div class="sidebar">
    <nav class="nav-links">
        <div class="nav-item"><a href="/docs/" class="nav-link">Projects and Documentation</a></div>
        <div class="nav-item"><a href="/events/" class="nav-link">Events</a></div>
        <div class="nav-item"><a href="/blog/" class="nav-link router-link-exact-active router-link-active">Blog</a>
        </div>
        <div class="nav-item"><a href="/downloads/" class="nav-link">Downloads</a></div>
        <div class="nav-item"><a href="/team/" class="nav-link">Team</a></div>
        <div class="nav-item"><a href="/users/" class="nav-link">Users</a></div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title"><span>中文资料</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="/zh/" class="nav-link external">博客</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://space.bilibili.com/390683219" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">B站</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://juejin.cn/user/13673577331607" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">掘金</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title">
                    <span>Links</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Apache Software Foundation
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://github.com/apache/skywalking/issues"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            GitHub Issue Tracker
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://lists.apache.org/list.html?dev@skywalking.apache.org" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Dev Mailing List
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/licenses/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            License
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/events/current-event"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Apache Events
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/security/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Security
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/sponsorship.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Sponsorship and Donate
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/thanks.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Thanks
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

    <script src="/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>









<script src="/js/main.min.d00d7a99f9e61382b1db35fac38e0e7bdd97f8d3c663a4c4b8d02c3f1d78d894.js" integrity="sha256-0A16mfnmE4Kx2zX6w44Oe92X&#43;NPGY6TEuNAsPx142JQ=" crossorigin="anonymous"></script>


<script src="/js/highlight.min.js"></script>
<script src="/js/mermaid.min.js"></script>
<script>
    window.onload = () => mermaid.init(undefined, ".language-mermaid");
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('pre code.language-json5').forEach((block) => {
      if (block.classList.contains('language-json5')) {
        try {
          hljs.registerLanguage('json5', function(hljs) {
            return hljs.getLanguage('json');
          });
          hljs.highlightElement(block);
        } catch (error) {
          console.error("Error parsing JSON5:", error);
        }
      }
    });
  });
</script>


<script defer
src="https://widget.kapa.ai/kapa-widget.bundle.js"
data-website-id="8a08392b-9c4d-4816-8bc4-f93e0ecdd2a7"
data-project-name="SkyWalking"
data-project-color="#2B74B8"
data-button-text="Ask AI"
data-search-mode-enabled="true"
data-modal-open-on-command-k="true"
data-modal-disclaimer="The AI supports multiple languages, but it may not be accessible in China, a proxy is required."
data-project-logo="https://miro.medium.com/v2/resize:fit:2400/0*kmS-5BQ8ShAhZ_F4.jpg"
data-modal-example-questions="What is Apache SkyWalking?,How to deploy SkyWalking?,How to inject agents non-intrusively?,How to setup trace sampling?"
data-button-position-top=""
data-button-position-right="20px"
data-button-position-bottom="200px"
data-button-position-left=""
data-consent-required="true"  
data-user-analytics-cookie-enabled="true"  
data-consent-screen-title="Help us improve our AI assistant"  
data-consent-screen-disclaimer="By clicking 'Allow tracking', you consent to anonymous user tracking which helps us improve our service. We don't collect any personally identifiable information."  
data-consent-screen-accept-button-text="Allow tracking"  
data-consent-screen-reject-button-text="No, thanks"
></script>




  </body>
  <script>
    $(function (){
      $('.doc-menu-button').on('click',function (){
        $('.td-sidebar').toggleClass('active')
      })
      $('.version-select').on('change', function (){
        var selectVersion = $(this).val().toLowerCase();
        var prefix = '';
        var url = location.href.replace(/(\/docs\/[a-zA-Z\-]+\/)([\w|\.]+)(\/.*)/, function (match, p1, p2, p3){
          prefix = p1 + selectVersion;
          return p1 + selectVersion + p3
        })
        go2SelectVersion(url, prefix)

      })
      function go2SelectVersion(url, prefix){
        $.ajax({
          url: url,
          type: "get",
          success:function(){
            location.href = url;
          },
          statusCode: {
            404:function(){
              location.href = prefix + '/readme/';
            }
          }
        });
      }
    })
  </script>
</html>
