<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="twitter:site" content="skywalking.apache.org">
<meta name="twitter:image:src" content="https://skywalking.apache.org/images/skywalking_400x400.png">
<meta property="og:image" content="https://skywalking.apache.org/images/skywalking_400x400.png">

<meta name="generator" content="Hugo 0.80.0" />

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3007530_pvozs1rz2wn.css">



<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/site.webmanifest">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<title>Monitoring ActiveMQ through SkyWalking | Apache SkyWalking</title><meta property="og:title" content="Monitoring ActiveMQ through SkyWalking" />
<meta property="og:description" content="This article will demonstrate the usage of the new ActiveMQ monitoring dashboard." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2024-04-19-monitoring-activemq-through-skywalking/" />
<meta property="article:published_time" content="2024-04-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-02-25T10:56:41+08:00" />
<meta itemprop="name" content="Monitoring ActiveMQ through SkyWalking">
<meta itemprop="description" content="This article will demonstrate the usage of the new ActiveMQ monitoring dashboard.">
<meta itemprop="datePublished" content="2024-04-19T00:00:00+00:00" />
<meta itemprop="dateModified" content="2025-02-25T10:56:41+08:00" />
<meta itemprop="wordCount" content="716">



<meta itemprop="keywords" content="ActiveMQ," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Monitoring ActiveMQ through SkyWalking"/>
<meta name="twitter:description" content="This article will demonstrate the usage of the new ActiveMQ monitoring dashboard."/>



<link rel="preload" href="/scss/main.min.1fe260c8ca23282a8c8a99d7aac14fce66676b2720ae8855a90668565b416088.css" as="style">
<link href="/scss/main.min.1fe260c8ca23282a8c8a99d7aac14fce66676b2720ae8855a90668565b416088.css" rel="stylesheet" integrity="">



<link rel="stylesheet" href="/css/docSearch.css" />
<link rel="stylesheet" href="/css/highlight-github.css" />


<script src="/js/jquery-3.6.0.min.js"></script>





    <title>Monitoring ActiveMQ through SkyWalking | Apache SkyWalking</title>
  </head>
  <body class="td-page td-blog">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand  flex-column flex-md-row td-navbar">
    <div class="sidebar-button">
      <i class="iconfont icon-menu"></i>
    </div>
    <a class="navbar-brand" href="/">
        <span class="navbar-logo"><img width="130" src="/images/logo.svg" alt="SkyWalking"></span> 
    </a>
    <div class="td-navbar-nav-scroll navbar-nav-wrapper" id="navigation">
        <ul class="navbar-nav mt-lg-0">
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/docs" ><span>Projects and Docs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/events" ><span>Events</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/blog" ><span>Blogs</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/downloads" ><span>Downloads</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/team" ><span>Team</span></a>
			</li>
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/users" ><span>Users</span></a>
			</li>
            
            
            
            
            
            <li class="nav-item mr-3 mb-lg-0">
                <span class="link dropdown blog">
                    <a class="link-name nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中文资料</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/zh/">博客</a>
                        <a class="dropdown-item" href="https://space.bilibili.com/390683219" target="_blank" rel="noopener noreferrer">
                            B站
                        </a>
                        <a class="dropdown-item" href="https://juejin.cn/user/13673577331607" target="_blank" rel="noopener noreferrer">
                            掘金
                        </a>
                    </div>
                </span>
            </li>

            
			
        </ul>
    </div>
    <div class="navbar-nav d-none d-lg-block search-input-box">
         
            
        
            
        
            
        
            
        
            
        
            
        
            
            <span class="link dropdown">
                <a class="link-name dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Links
                </a>
                <div class="dropdown-menu">
                    
                    <a class="dropdown-item" href="http://www.apache.org/">Apache Software Foundation</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/issues">GitHub Issue Tracker</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/discussions">Discussion</a> 
                    <a class="dropdown-item" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">Dev Mailing List</a> 
                    <a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/SKYWALKING/Home">WIKI</a> 
                    <a class="dropdown-item" href="http://www.apache.org/licenses/">License</a> 
                    <a class="dropdown-item" href="http://www.apache.org/events/current-event">Apache Events</a> 
                    <a class="dropdown-item" href="http://www.apache.org/security/">Security</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Sponsor and Donate</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a> 
                    <a class="dropdown-item" href="https://apache.org/foundation/policies/privacy.html">Privacy</a> 
                </div>
            </span>
            
        
        
<div id="docsearch"></div>


    </div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row container container-center">

          <main class="col-12 col-md-12 col-xl-10 pl-md-4 pr-md-4" role="main">
            
<div class="td-content">
	<h1>Monitoring ActiveMQ through SkyWalking</h1>
	<div class="lead">This article will demonstrate the usage of the new ActiveMQ monitoring dashboard.</div>
	<div class="td-byline mb-4">
		By <b>Ziyan Chen</b> |
		<time datetime="2024-04-19" class="text-muted">Friday, April 19, 2024</time>


		
		<p class="mt-1 tags-box">
			<i class="iconfont icon-tags"></i>Tags |
			
			<span> <a href="/tags/activemq">ActiveMQ</a></span>
			
		</p>
		


	</div>
	<p><img src="activemq_logo.png" alt="icon"></p>
<h2 id="introduction">Introduction</h2>
<p><a href="https://activemq.apache.org/components/classic/">Apache ActiveMQ Classic</a> is a popular and powerful open-source messaging and integration pattern server. Founded in 2004, it has evolved into a mature and widely used open-source messaging middleware that complies with the <code>Java Message Service (JMS)</code>.
Today, with its stability and wide range of feature support, it still has a certain number of users of <code>small and medium-sized</code> enterprises. It‘s high-performance version <a href="https://activemq.apache.org/components/artemis/">Apache Artemis</a> is developing rapidly and is also attracting attention from users of ActiveMQ.</p>
<p>ActiveMQ has broad support for <a href="https://docs.oracle.com/javase/tutorial/jmx/overview/index.html">JMX (Java Management Extensions)</a>, allowing to be monitored through <code>JMX MBean</code>.
After enabling JMX, you can use JAVA&rsquo;s built-in <code>jconsole</code> or <code>VisualVM</code> to view the metrics. In addition, some Collector components can also be used to convert <code>JMX-style</code> data into <code>Prometheus-style</code> data, which is suitable for more tools.</p>
<p><a href="https://opentelemetry.io/">OpenTelemetry</a> as an industry-recognized, standardized solution that provides consistent and interoperable telemetry data collection, transmission, and analysis capabilities for distributed systems, and is also used here for data collection and transmission.
Although it can directly accept <code>JMX</code> type data, the JMX indicators for collecting ActiveMQ are not in the standard library, and some versions are incompatible, so this article adopts two steps: convert <code>JMX data</code> into <code>Prometheus-style</code> indicator data, and then use OpenTelemetry to scrape <code>HTTP</code> endpoint data.</p>
<p><a href="https://skywalking.apache.org/">SkyWalking</a> as a one-stop distributed system monitoring solution, it accepts metrics from <code>ActiveMQ</code> and provides a basic monitoring dashboard.</p>
<h2 id="deployment">Deployment</h2>
<p>Please set up the following services:</p>
<ol>
<li><a href="https://github.com/apache/skywalking">SkyWalking OAP, v10.0+</a>.</li>
<li><a href="https://activemq.apache.org/components/classic/download/">ActiveMQ v6.0.X+</a>.</li>
<li><a href="https://github.com/prometheus/jmx_exporter/releases">JMX Exporter v0.20.0</a>. If using docker, refer <a href="https://github.com/bitnami/containers/tree/main/bitnami/jmx-exporter">bitnami/jmx-exporter</a>.</li>
<li><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib">OpenTelmetry-Collector v0.92.0</a>.</li>
</ol>
<h3 id="preparation">Preparation</h3>
<p>The following describes how to deploy ActiveMQ with 2 single-node brokers and SkyWalking OAP with one single node. JMX Exporter runs in agent mode (recommended).</p>
<h3 id="configuration">Configuration</h3>
<ol>
<li><a href="https://activemq.apache.org/components/classic/documentation/jmx">Enable JMX</a> in ActiveMQ, the JMX remote port defaults to <code>1616</code>, you can change it through <code>ACTIVEMQ_SUNJMX_START</code>.</li>
<li>Set up the exporter:
<ol>
<li>[Recommended] If run exporter in <code>agent mode</code>, need to append the startup parameter <code>-DACTIVEMQ_OPTS=-javaagent:{activemqPath}/bin/jmx_prometheus_javaagent-0.20.0.jar=2345:{activemqPath}/conf/config.yaml</code> in ActiveMQ env, then exporter server starts at the same time.</li>
<li>If run exporter in <code>single server</code>, <a href="https://github.com/prometheus/jmx_exporter/tree/release-0.20.0?tab=readme-ov-file#running-the-standalone-http-server">refer here</a> to deploy the server alone.</li>
<li><code>2345</code> is open HTTP port that can be customized. JMX&rsquo;s metrics can be queried through <code>http://localhost:2345/metrics</code>.</li>
</ol>
</li>
</ol>
<p>example of <code>docker-compose.yml</code> with agent exporter for ActiveMQ:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#000080">version</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#39;3.8&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">services</span>:<span style="color:#bbb"> 
</span><span style="color:#bbb">  </span><span style="color:#000080">amq1</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>apache/activemq-classic:latest<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">container_name</span>:<span style="color:#bbb"> </span>amq1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">hostname</span>:<span style="color:#bbb"> </span>amq1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq1/conf/activemq.xml:/opt/apache-activemq/conf/activemq.xml<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq1/bin/jmx_prometheus_javaagent-0.20.0.jar:/opt/apache-activemq/bin/jmx_prometheus_javaagent-0.20.0.jar<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq1/conf/config.yaml:/opt/apache-activemq/conf/config.yaml<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;61616:61616&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;8161:8161&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;2345:2345&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">environment</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">ACTIVEMQ_OPTS</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;-javaagent:/opt/apache-activemq/bin/jmx_prometheus_javaagent-0.20.0.jar=2345:/opt/apache-activemq/conf/config.yaml&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">ACTIVEMQ_BROKER_NAME</span>:<span style="color:#bbb"> </span>broker-1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amqtest    <span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">amq2</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>apache/activemq-classic:latest<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">container_name</span>:<span style="color:#bbb"> </span>amq2<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">hostname</span>:<span style="color:#bbb"> </span>amq2<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq2/conf/activemq.xml:/opt/apache-activemq/conf/activemq.xml<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq2/bin/jmx_prometheus_javaagent-0.20.0.jar:/opt/apache-activemq/bin/jmx_prometheus_javaagent-0.20.0.jar<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ~/activemq2/conf/config.yaml:/opt/apache-activemq/conf/config.yaml      <span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;61617:61616&#34;</span><span style="color:#bbb"> 
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;8162:8161&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;2346:2346&#34;</span><span style="color:#bbb">      
</span><span style="color:#bbb">    </span><span style="color:#000080">environment</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">ACTIVEMQ_OPTS</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;-javaagent:/opt/apache-activemq/bin/jmx_prometheus_javaagent-0.20.0.jar=2346:/opt/apache-activemq/conf/config.yaml&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">ACTIVEMQ_BROKER_NAME</span>:<span style="color:#bbb"> </span>broker-2 <span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amqtest<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">otel-collector1</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>otel/opentelemetry-collector:latest<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">container_name</span>:<span style="color:#bbb"> </span>otel-collector1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">command</span>:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#d14">&#34;--config=/etc/otel-collector-config.yaml&#34;</span><span style="color:#bbb"> </span>]<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ./otel-collector-config1.yaml:/etc/otel-collector-config.yaml<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">depends_on</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amq1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amqtest <span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">otel-collector2</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>otel/opentelemetry-collector:latest<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">container_name</span>:<span style="color:#bbb"> </span>otel-collector2<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">command</span>:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#d14">&#34;--config=/etc/otel-collector-config.yaml&#34;</span><span style="color:#bbb"> </span>]<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ./otel-collector-config2.yaml:/etc/otel-collector-config.yaml<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">depends_on</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amq2<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- amqtest            <span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">amqtest</span>:<span style="color:#bbb">
</span></code></pre></div><p>example of <code>otel-collector-config.yaml</code> for OpenTelemetry:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000080">receivers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">prometheus</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">config</span>:<span style="color:#bbb">
</span><span style="color:#bbb">     </span><span style="color:#000080">scrape_configs</span>:<span style="color:#bbb">
</span><span style="color:#bbb">       </span>- <span style="color:#000080">job_name</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#39;activemq-monitoring&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">         </span><span style="color:#000080">scrape_interval</span>:<span style="color:#bbb"> </span>30s<span style="color:#bbb">
</span><span style="color:#bbb">         </span><span style="color:#000080">static_configs</span>:<span style="color:#bbb">
</span><span style="color:#bbb">           </span>- <span style="color:#000080">targets</span>:<span style="color:#bbb"> </span>[<span style="color:#d14">&#39;amq1:2345&#39;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">             </span><span style="color:#000080">labels</span>:<span style="color:#bbb">
</span><span style="color:#bbb">               </span><span style="color:#000080">cluster</span>:<span style="color:#bbb"> </span>activemq-broker1<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">processors</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">batch</span>:<span style="color:#bbb">
</span><span style="color:#bbb"> 
</span><span style="color:#bbb"></span><span style="color:#000080">exporters</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">otlp</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">endpoint</span>:<span style="color:#bbb"> </span>oap:11800<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">tls</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">insecure</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">service</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">pipelines</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">metrics</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">receivers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- prometheus<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">processors</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- batch<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">exporters</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- otlp<span style="color:#bbb">
</span></code></pre></div><p>example of <code>config.yaml</code> for ActiveMQ Exporter:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#555">---</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">startDelaySeconds</span>:<span style="color:#bbb"> </span><span style="color:#099">10</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">username</span>:<span style="color:#bbb"> </span>admin<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">password</span>:<span style="color:#bbb"> </span>activemq<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">ssl</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">false</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">lowercaseOutputName</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">false</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">lowercaseOutputLabelNames</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">false</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">includeObjectNames</span>:<span style="color:#bbb"> </span>[<span style="color:#d14">&#34;org.apache.activemq:*&#34;</span>,<span style="color:#d14">&#34;java.lang:type=OperatingSystem&#34;</span>,<span style="color:#d14">&#34;java.lang:type=GarbageCollector,*&#34;</span>,<span style="color:#d14">&#34;java.lang:type=Threading&#34;</span>,<span style="color:#d14">&#34;java.lang:type=Runtime&#34;</span>,<span style="color:#d14">&#34;java.lang:type=Memory&#34;</span>,<span style="color:#d14">&#34;java.lang:name=*&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">excludeObjectNames</span>:<span style="color:#bbb"> </span>[<span style="color:#d14">&#34;org.apache.activemq:type=ColumnFamily,*&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">autoExcludeObjectNameAttributes</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">excludeObjectNameAttributes</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#d14">&#34;java.lang:type=OperatingSystem&#34;</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;ObjectName&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#d14">&#34;java.lang:type=Runtime&#34;</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;ClassPath&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;SystemProperties&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">rules</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#000080">pattern</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;.*&#34;</span><span style="color:#bbb">    
</span></code></pre></div><h3 id="steps">Steps</h3>
<ol>
<li>Start <code>ActiveMQ</code>, and the Exporter(agent) and the service start at the same time.</li>
<li>Start <code>SkyWalking OAP</code> and <code>SkyWalking UI</code>.</li>
<li>Start <code>OpenTelmetry-Collector</code>.</li>
</ol>
<p>After completed, node metrics will be captured and pushed to SkyWalking.</p>
<h2 id="metrics">Metrics</h2>
<p>Monitoring metrics involve in <code>Cluster Metrics</code>, <code>Broker Metrics</code>, and <code>Destination Metrics</code>.</p>
<ul>
<li>Cluster Metrics: including memory usage, rates of write/read, and average/max duration of write.</li>
<li>Broker Metrics: including node state, number of connections, number of producers/consumers, and rate of write/read under the broker. Depending on the cluster mode, one cluster may include one or more brokers.</li>
<li>Destination Metrics: including number of producers/consumers, messages in different states, queues, and enqueue duration in a queue/topic.</li>
</ul>
<h3 id="cluster-metrics">Cluster Metrics</h3>
<p><img src="./activemq_cluster_panel.png" alt="activemq_cluster_panel"></p>
<ul>
<li>System Load: range in [0, 100].</li>
<li>Thread Count: the number of threads currently used by the JVM.</li>
<li>Heap Memory: capacity of heap memory.</li>
<li>GC: memory of ActiveMQ is managed by Java&rsquo;s garbage collection (GC) process.</li>
<li>Enqueue/Dequeue/Dispatch/Expired Rate: growth rate of messages in different states.</li>
<li>Average/Max Enqueue Time: time taken to join the queue.</li>
</ul>
<h3 id="broker-metrics">Broker Metrics</h3>
<p><img src="./activemq_broker_panel.png" alt="activemq_broker_panel"></p>
<ul>
<li>Uptime: duration of the node.</li>
<li>State: 1 = slave node, 0 = master node.</li>
<li>Current Connentions: number of connections.</li>
<li>Current Producer/Consumer Count: number of current producers/consumers.</li>
<li>Increased Producer/Consumer Count: number of increased producers/consumers.</li>
<li>Enqueue/Dequeue Count: number of enqueue and dequeue.</li>
<li>Enqueue/Dequeue Rate: rate of enqueue and dequeue.</li>
<li>Memory Percent Usage: amount of memory space used by undelivered messages.</li>
<li>Store Percent Usage: space used by pending persistent messages.</li>
<li>Temp Percent Usage: space used by non-persistent messages.</li>
<li>Average/Max Message Size: number of messages.</li>
<li>Queue Size: number of messages in the queue.</li>
</ul>
<h3 id="destination-metrics">Destination Metrics</h3>
<p><img src="./activemq_destination_panel.png" alt="activemq_destination_panel"></p>
<ul>
<li>Produser/Consumer Count: number of producers/Consumers.</li>
<li>Queue Size: unacknowledged messages of the queue.</li>
<li>Memory usage: usage of memory.</li>
<li>Enqueue/Dequeue/Dispatch/Expired/Inflight Count: number of messages in different states.</li>
<li>Average/Max Message Size: number of messages.</li>
<li>Average/Max Enqueue Time: time taken to join the queue.</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://activemq.apache.org/components/classic/documentation/clustering">ActiveMQ Classic clustering</a></li>
<li><a href="https://github.com/prometheus/jmx_exporter/tree/release-0.20.0#Configuration">JMX Exporter Configuration</a></li>
<li><a href="https://github.com/prometheus/jmx_exporter/tree/release-0.20.0">JMX Exporter-Running the Standalone HTTP Server</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/jmxreceiver">OpenTelemetry Collector Contrib Jmxreceiver</a></li>
</ul>

	

	<ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5">
  <li>
    <a href="/blog/2024-03-18-monitor-kubernetes-network-by-ebpf/" class="btn btn-primary "><span class="mr-1">←</span> Previous</a>
  </li>
    <a href="/blog/2024-05-13-skywalking-10-release/" class="btn btn-primary ">Next <span class="ml-1">→</span></a>
  </li>
</ul>

</div>


          </main>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">

            <div class="tags-wrapper">
    <div class="font-weight-bold post-meta ">
        <i class="iconfont icon-tags pr-1" aria-hidden="true"></i>
        Tags
    </div>
    <ul class="tags-box">
        
        <li>
            <a href="/tags/activemq/" class="tag-link">ActiveMQ</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/agent/" class="tag-link">Agent</a>
            <span class="count">10</span>
        </li>
        
        <li>
            <a href="/tags/apache-shenyu-incubating/" class="tag-link">Apache ShenYu (incubating)</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/apisix/" class="tag-link">APISIX</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/apm/" class="tag-link">APM</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/arthas/" class="tag-link">Arthas</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/aurora/" class="tag-link">Aurora</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/aws/" class="tag-link">AWS</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/banyandb/" class="tag-link">BanyanDB</a>
            <span class="count">4</span>
        </li>
        
        <li>
            <a href="/tags/browser/" class="tag-link">Browser</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/chaos-engineering/" class="tag-link">Chaos Engineering</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/chaos-mesh/" class="tag-link">Chaos Mesh</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/clickhouse/" class="tag-link">ClickHouse</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/conference/" class="tag-link">Conference</a>
            <span class="count">6</span>
        </li>
        
        <li>
            <a href="/tags/database/" class="tag-link">Database</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/demo/" class="tag-link">Demo</a>
            <span class="count">3</span>
        </li>
        
        <li>
            <a href="/tags/design/" class="tag-link">Design</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/dotnetcore/" class="tag-link">DotNetCore</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/ebpf/" class="tag-link">eBPF</a>
            <span class="count">8</span>
        </li>
        
        <li>
            <a href="/tags/golang/" class="tag-link">Golang</a>
            <span class="count">5</span>
        </li>
        
        <li>
            <a href="/tags/grafana/" class="tag-link">Grafana</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/http/" class="tag-link">HTTP</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/infrastructure-monitoring/" class="tag-link">Infrastructure Monitoring</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/iotdb/" class="tag-link">IoTDB</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/istio/" class="tag-link">Istio</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/java/" class="tag-link">Java</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/kafka/" class="tag-link">Kafka</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/kong/" class="tag-link">Kong</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/kubernetes/" class="tag-link">Kubernetes</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/lal/" class="tag-link">LAL</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/license/" class="tag-link">License</a>
            <span class="count">5</span>
        </li>
        
        <li>
            <a href="/tags/logging/" class="tag-link">Logging</a>
            <span class="count">3</span>
        </li>
        
        <li>
            <a href="/tags/logs/" class="tag-link">Logs</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/metric/" class="tag-link">Metric</a>
            <span class="count">6</span>
        </li>
        
        <li>
            <a href="/tags/metrics/" class="tag-link">Metrics</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/nginx/" class="tag-link">Nginx</a>
            <span class="count">5</span>
        </li>
        
        <li>
            <a href="/tags/observability/" class="tag-link">Observability</a>
            <span class="count">10</span>
        </li>
        
        <li>
            <a href="/tags/ospp/" class="tag-link">OSPP</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/performance/" class="tag-link">Performance</a>
            <span class="count">3</span>
        </li>
        
        <li>
            <a href="/tags/profiling/" class="tag-link">Profiling</a>
            <span class="count">5</span>
        </li>
        
        <li>
            <a href="/tags/promql/" class="tag-link">PromQL</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/python/" class="tag-link">Python</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/r3/" class="tag-link">R3</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/rds/" class="tag-link">RDS</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/release-blog/" class="tag-link">Release Blog</a>
            <span class="count">8</span>
        </li>
        
        <li>
            <a href="/tags/restful/" class="tag-link">RESTFul</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/rocketmq/" class="tag-link">RocketMQ</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/satellite/" class="tag-link">Satellite</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/service-hierarchy/" class="tag-link">Service Hierarchy</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/service-mesh/" class="tag-link">Service Mesh</a>
            <span class="count">6</span>
        </li>
        
        <li>
            <a href="/tags/sharding-sphere/" class="tag-link">Sharding-Sphere</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/sharding-sphere-proxy/" class="tag-link">Sharding-Sphere-proxy</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/skywalking/" class="tag-link">SkyWalking</a>
            <span class="count">5</span>
        </li>
        
        <li>
            <a href="/tags/spring/" class="tag-link">Spring</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/storage/" class="tag-link">Storage</a>
            <span class="count">4</span>
        </li>
        
        <li>
            <a href="/tags/testing/" class="tag-link">Testing</a>
            <span class="count">3</span>
        </li>
        
        <li>
            <a href="/tags/trace/" class="tag-link">Trace</a>
            <span class="count">4</span>
        </li>
        
        <li>
            <a href="/tags/tracing/" class="tag-link">Tracing</a>
            <span class="count">10</span>
        </li>
        
        <li>
            <a href="/tags/tutorial/" class="tag-link">Tutorial</a>
            <span class="count">1</span>
        </li>
        
        <li>
            <a href="/tags/user-manual/" class="tag-link">User Manual</a>
            <span class="count">2</span>
        </li>
        
        <li>
            <a href="/tags/video/" class="tag-link">Video</a>
            <span class="count">8</span>
        </li>
        
        <li>
            <a href="/tags/web-performance/" class="tag-link">Web-performance</a>
            <span class="count">1</span>
        </li>
        
    </ul>
</div>



            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">











</div>






<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#deployment">Deployment</a>
          <ul>
            <li><a href="#preparation">Preparation</a></li>
            <li><a href="#configuration">Configuration</a></li>
            <li><a href="#steps">Steps</a></li>
          </ul>
        </li>
        <li><a href="#metrics">Metrics</a>
          <ul>
            <li><a href="#cluster-metrics">Cluster Metrics</a></li>
            <li><a href="#broker-metrics">Broker Metrics</a></li>
            <li><a href="#destination-metrics">Destination Metrics</a></li>
          </ul>
        </li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>




<script>
  $(function () {
    var $toc = $("#TableOfContents");
    if (!$toc || !$toc.length) {
      return;
    }
    var top = $toc.offset().top;
    $(window).on("scroll", debounce(setTop, 100))
    $(window).on("scroll", debounce(addActive, 30))

    function addActive() {
      var scrollValue = $(window).scrollTop();
      var topEle = null;
      $.each($('main h1, main h2, main h3'), function (index, item) {
        if ($(item).offset().top - 70 > scrollValue) {
          return
        }
        if (!topEle) {
          topEle = item
        } else if ($(item).offset().top >= $(topEle).offset().top) {
          topEle = item
        }
        if (topEle) {
          var id = $(item).attr('id');
          $toc.find('a').removeClass("active").end().find('a[href="' + '#' + id + '"]').addClass("active")
        }
      })
    }

    function setTop() {
      var scrollValue = $(window).scrollTop();
      if (scrollValue >= top - 70) {
        $toc.addClass('fixed')
      } else {
        $toc.removeClass('fixed')
      }
    }

    function debounce(fn, wait) {
      var timeout = null;
      return function () {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          fn.apply(this, arguments);
        }, wait);
      };
    }
  })

</script>

          </div>
        </div>
      </div>
      
<footer class="py-5 sky-row">
  <div class="container-fluid text-center">
    <div class="">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-color" target="_blank" href="https://twitter.com/asfskywalking">
      <i class="iconfont icon-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-color" target="_blank" href="http://s.apache.org/slack-invite">
      <i class="iconfont icon-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing list" aria-label="Mailing list">
    <a class="text-color" target="_blank" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">
      <i class="iconfont icon-email"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-color" target="_blank" href="https://github.com/apache/skywalking">
      <i class="iconfont icon-github"></i>
    </a>
  </li>
  
</ul>

        
        
    </div>
    <div class="">

        <small class="text-color">&copy; 2017 - 2025 The Apache Software Foundation All Rights Reserved</small>
        
	
    </div>
    <div class="">
      <small class="text-color mt-4">Apache SkyWalking, SkyWalking, Apache, the Apache feather logo, and the Apache SkyWalking project logo are either registered trademarks or trademarks of the Apache Software Foundation.</small>
    </div>
  </div>
</footer>


    </div>
    





































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    
<div id="popup">
    <div class="mask">
        <img src=""/>
    </div>
</div>

    <div class="sidebar-mask"></div>
<div class="sidebar">
    <nav class="nav-links">
        <div class="nav-item"><a href="/docs/" class="nav-link">Projects and Documentation</a></div>
        <div class="nav-item"><a href="/events/" class="nav-link">Events</a></div>
        <div class="nav-item"><a href="/blog/" class="nav-link router-link-exact-active router-link-active">Blog</a>
        </div>
        <div class="nav-item"><a href="/downloads/" class="nav-link">Downloads</a></div>
        <div class="nav-item"><a href="/team/" class="nav-link">Team</a></div>
        <div class="nav-item"><a href="/users/" class="nav-link">Users</a></div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title"><span>中文资料</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="/zh/" class="nav-link external">博客</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://space.bilibili.com/390683219" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">B站</a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://juejin.cn/user/13673577331607" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">掘金</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="nav-item">
            <div class="dropdown-wrapper open">
                <a class="dropdown-title">
                    <span>Links</span>
                    <span class="arrow down"></span>
                </a>
                <ul class="nav-dropdown">
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Apache Software Foundation
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://github.com/apache/skywalking/issues"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            GitHub Issue Tracker
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://lists.apache.org/list.html?dev@skywalking.apache.org" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Dev Mailing List
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/licenses/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            License
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/events/current-event"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Apache Events
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/security/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Security
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/sponsorship.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Sponsorship and Donate
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/thanks.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Thanks
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

    <script src="/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>









<script src="/js/main.min.d00d7a99f9e61382b1db35fac38e0e7bdd97f8d3c663a4c4b8d02c3f1d78d894.js" integrity="sha256-0A16mfnmE4Kx2zX6w44Oe92X&#43;NPGY6TEuNAsPx142JQ=" crossorigin="anonymous"></script>


<script src="/js/highlight.min.js"></script>
<script src="/js/mermaid.min.js"></script>
<script>
    window.onload = () => mermaid.init(undefined, ".language-mermaid");
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('pre code.language-json5').forEach((block) => {
      if (block.classList.contains('language-json5')) {
        try {
          hljs.registerLanguage('json5', function(hljs) {
            return hljs.getLanguage('json');
          });
          hljs.highlightElement(block);
        } catch (error) {
          console.error("Error parsing JSON5:", error);
        }
      }
    });
  });
</script>





  </body>
</html>
